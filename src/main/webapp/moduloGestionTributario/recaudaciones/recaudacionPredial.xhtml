<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../WEB-INF/template/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="title">
        Recaudación Predial
    </ui:define>

    <ui:define name="head">
        <style type="text/css">
            body .ui-inputfield {
                border-width: 1px 1px 1px 1px;
            }
            body .ui-inputfield.ui-state-focus {
                border-width: 1px 1px 1px 1px;
            }
            body .ui-panelgrid .ui-panelgrid-cell {
                border: none;
                padding: 0.5em;
                font-size: 1em;
            }
            .ui-panelgrid .ui-panelgrid-cell{
                border-style: hidden;
            }
            body .ui-fieldset {
                padding: 0.5em;
            }
            .ui-panelgrid {
                border-collapse: inherit;
            }
            body .ui-panelgrid .ui-panelgrid-cell {
                border: none;
                padding: 0.1px 0.1px 0.1px 0.1px;
                font-size: 1em;
            }
        </style>
    </ui:define>

    <ui:define name="content">
        <h:form id="mainForm" >
            <p:panel>
                <p:panelGrid columns="2" columnClasses="ui-grid-col-2, ui-grid-col-10" 
                             layout="grid" styleClass="ui-panelgrid-blank form-group">
                    <p:panelGrid columns="1">
                        <p:selectOneRadio value="#{recaudacionPredialMB.esUrbano}" columns="1" layout="grid">
                            <f:selectItem itemLabel="Urbano" itemValue="#{true}" />
                            <f:selectItem itemLabel="Rural" itemValue="#{false}" />
                            <!--<f:selectItem itemLabel="Otros" itemValue="#{false}" />-->
                        </p:selectOneRadio>
                    </p:panelGrid>
                    <p:panelGrid columns="1">
                        <p:outputLabel value="Tipo de Consulta" style="font-size: 15px; font-weight: bolder;"/>
                        <p:selectOneRadio id="selecttipoconsulta" value="#{recaudacionPredialMB.tipoConsulta}">
                            <f:selectItem itemLabel="Codigo Predial" itemValue="3"/>
                            <f:selectItem itemLabel="Contribuyente" itemValue="2"/>
                            <f:selectItem itemLabel="Código Moviliario" itemValue="1"/>
                            <f:selectItem itemLabel="Código Anterior" itemValue="4"/>
                            <f:selectItem itemLabel="Código Catastral" itemValue="5"/>
                            <p:ajax update="mainForm" />
                        </p:selectOneRadio>
                        <p:panelGrid rendered="#{recaudacionPredialMB.tipoConsulta eq 1}">
                            <div class="ui-g-12 ui-md-6">
                                <div class="ui-inputgroup">
                                    <p:inputText value="#{recaudacionPredialMB.predioModel.numPredio}" style="width: 60%;border: 1px solid #00796B;" />
                                    <p:commandButton icon="fa fa-search" style="border-radius: 0px 5px 5px 0px;height: "
                                                     actionListener="#{recaudacionPredialMB.consultarEmisiones()}"
                                                     update="mainForm"/>
                                </div>
                            </div>
                        </p:panelGrid>
                        <p:panelGrid rendered="#{recaudacionPredialMB.tipoConsulta eq 5}">
                            <div class="ui-g-12 ui-md-6">
                                <div class="ui-inputgroup">
                                    <p:inputText value="#{recaudacionPredialMB.predioModel.claveCat}" style="width: 60%;border: 1px solid #00796B;"/>
                                    <p:commandButton icon="fa fa-search" style="border-radius: 0px 5px 5px 0px;height: "
                                                     actionListener="#{recaudacionPredialMB.consultarEmisiones()}"
                                                     update="mainForm"/>
                                </div>
                            </div>
                        </p:panelGrid>
                        <p:panelGrid rendered="#{recaudacionPredialMB.tipoConsulta eq 4}">
                            <div class="ui-g-12 ui-md-6">
                                <div class="ui-inputgroup">
                                    <p:inputText value="#{recaudacionPredialMB.predioModel.predialAnt}" style="width: 60%;border: 1px solid #00796B;"/>
                                    <p:commandButton icon="fa fa-search" style="border-radius: 0px 5px 5px 0px;height: "
                                                     actionListener="#{recaudacionPredialMB.consultarEmisiones()}"
                                                     update="mainForm"/>
                                </div>
                            </div>
                        </p:panelGrid>
                        <p:panelGrid rendered="#{recaudacionPredialMB.tipoConsulta eq 2}">
                            <div class="ui-g-12 ui-md-6">
                                <div class="ui-inputgroup">
                                    <p:inputText value="#{recaudacionPredialMB.nombreContribuyente}" placeholder="NOMBRES Y APELLIDOS" 
                                                 style="width: 100%"/>
                                    <p:commandButton icon="fa fa-search" style="border-radius: 0px 5px 5px 0px;height: "
                                                     actionListener="#{recaudacionPredialMB.consultarEmisiones()}"
                                                     update="mainForm" />
                                </div>
                            </div>
                        </p:panelGrid>
                        <p:panelGrid columns="10" style="width: 95%;" styleClass="ui-responsive" rendered="#{recaudacionPredialMB.tipoConsulta eq 3}">
                            <p:column><h:outputText value="PROVINCIA " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column><h:outputText value="CANTON " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column><h:outputText value="PARROQUIA " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column><h:outputText value="ZONA " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column><h:outputText value="SECTOR " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column><h:outputText value="MANZANA " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column><h:outputText value="LOTE " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column><h:outputText value="BLOQUE " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column><h:outputText value="PISO " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column><h:outputText value="UNIDAD " style="font-size: 13px; font-weight: bolder;"/></p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.provincia}" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText></p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.canton}" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText></p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.parroquiaShort}" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText></p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.zona}" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText></p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.sector}" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText></p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.mz}" maxlength="3" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText></p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.solar}" maxlength="3" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText>
                            </p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.bloque}" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText>   </p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.piso}" maxlength="3" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText></p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.predioModel.unidad}" maxlength="3" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                    <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                </p:inputText>
                            </p:column>
                        </p:panelGrid>
                    </p:panelGrid>
                </p:panelGrid>
                <p:fieldset legend="Emision Predial">
                    <p:panelGrid id="datos" columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group">
                        <p:panelGrid columns="2" style="width: 100%">
                            <h:panelGroup>
                                <p:outputLabel value="TOT. CANCELAR:" style="font-size: 15px; font-weight: bolder;"/>
                                <p:outputLabel value="#{recaudacionPredialMB.totalEmisiones}" style="font-size: 22px; font-weight: bolder; color: blue;"/>
                            </h:panelGroup>
                            <p:commandButton value="PROCESAR" actionListener="#{recaudacionPredialMB.procesarPago}" process="@this" style="font-size: 13px; font-weight: bolder; float: right;" styleClass="btnStyle" icon="ui-icon-gear" iconPos="right" />
                        </p:panelGrid>
                        <p:dataTable id="dataLiquidaciones" widgetVar="dataLiquidaciones"
                                     value="#{recaudacionPredialMB.emisionesPrediales}"
                                     var="emision" selection="#{recaudacionPredialMB.emisionesPredialesTemp}"
                                     rowKey="#{emision.id}"
                                     scrollable="true" scrollHeight="350" selectionMode="multiple" reflow="true" rows="100"
                                     emptyMessage="Criterios de Busqueda no encontrado">
                            <p:ajax event="rowSelect" listener="#{recaudacionPredialMB.seleccionarEmision(1)}" update="mainForm:datos"/>
                            <p:ajax event="rowUnselect" listener="#{recaudacionPredialMB.seleccionarEmision(1)}" update="mainForm:datos"/>
                            <p:ajax event="toggleSelect" listener="#{recaudacionPredialMB.seleccionarEmision(1)}" update="mainForm:datos"/>
                            <p:ajax event="rowSelectCheckbox" listener="#{recaudacionPredialMB.seleccionarEmision(1)}" update="mainForm:datos"/>
                            <p:ajax event="rowUnselectCheckbox" listener="#{recaudacionPredialMB.seleccionarEmision(1)}" update="mainForm:datos"/>
                            <!--<p:column  selectionMode="multiple"  style="width:16px;text-align:center"></p:column>-->
                            <p:column headerText="Año" style="text-align: center">
                                <p:outputLabel value="#{emision.anio}" />
                            </p:column>
                            <p:column headerText="Codigo Predial">
                                <p:outputLabel value="#{emision.codigoLocal}" />
                            </p:column>
                            <p:column headerText="Contribuyente" >
                                <p:outputLabel value="#{emision.nombreComprador}" />
                            </p:column>
                            <p:column headerText="Emision">
                                <h:outputText value="#{emision.totalPago}" >
                                    <f:convertNumber pattern="$ #,##0.00" />
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Adicionales">
                                <h:outputText id="adicionales" value="#{emision.recargo.add(emision.interes).subtract(emision.descuento)}">
                                    <f:convertNumber pattern="$ #,##0.00" />
                                </h:outputText>
                                <p:tooltip for="adicionales">
                                    <p:panelGrid columns="2">
                                        <p:outputLabel value="Descuento: " style="color: #000000"/>
                                        <h:outputText value="#{emision.descuento}" style="color: #000000">
                                            <f:convertNumber pattern="$ #,##0.00" />
                                        </h:outputText>
                                        <p:outputLabel value="Recargo: " style="color: #000000"/>
                                        <h:outputText value="#{emision.recargo}" style="color: #000000">
                                            <f:convertNumber pattern="$ #,##0.00" />
                                        </h:outputText>
                                        <p:outputLabel value="Interes: " style="color: #000000"/>
                                        <h:outputText value="#{emision.interes}" style="color: #000000">
                                            <f:convertNumber pattern="$ #,##0.00" />
                                        </h:outputText>
                                    </p:panelGrid>
                                </p:tooltip>
                            </p:column>
                            <p:column headerText="Coactiva" style="text-align: center;" width="80">
                                <h:outputText value="#{emision.valorCoactiva}">
                                    <f:convertNumber pattern="$ #,##0.00" />
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Valor por Pagar" style="text-align: center;" width="100">
                                <h:outputText value="#{emision.pagoFinal}">
                                    <f:convertNumber pattern="$ #,##0.00" />
                                </h:outputText>
                            </p:column>
                        </p:dataTable>
                    </p:panelGrid>
                </p:fieldset>
            </p:panel>
        </h:form>


        <p:dialog header="Procesar Pago" widgetVar="dlgProcesar" resizable="false"
                  closeOnEscape="true" modal="true" width="70%" height="400px" position="center">
            <h:form id="formProcesar">
                <p:fieldset legend="PAGO: #{recaudacionPredialMB.emisionSeleccionada.tipoLiquidacion.prefijo} - #{recaudacionPredialMB.emisionSeleccionada.tipoLiquidacion.nombreTitulo}"
                            style="font-weight: bold;">
                    <p:dataTable value="#{recaudacionPredialMB.emisionesACobrar}" var="emision" scrollable="true" scrollHeight="150"
                                 rowKey="#{emision.id}" resizeMode="expand" style="width: 100%" >
                        <p:column headerText="No." style="text-align: center;"  width="10%">
                            <p:outputLabel value="#{emision.idLiquidacion eq null ? '0' : emision.idLiquidacion}"/>
                        </p:column>
                        <p:column headerText="Año" style="text-align: center;" width="10%">
                            <p:outputLabel value="#{emision.anio}"/>
                        </p:column>
                        <!--                        <p:column headerText="N. Predio" style="text-align: center;" width="20%">
                                                    <p:outputLabel value="# {emision.predio.numPredio}"/>
                                                    <p:outputLabel value="# {emision.predioRustico.numPredioRustico}"/></p:column>-->
                        <p:column headerText="Contribuyente" style="text-align: center" width="45%">
                            <p:outputLabel value="#{emision.identificacion}-#{emision.comprador==null?emision.nombreComprador :emision.comprador.nombreCompleto}"/>
                        </p:column>
                        <p:column headerText="Valor" style="text-align: center;" width="15%">
                            <p:outputLabel value="#{emision.totalPago}"/>
                        </p:column>
                    </p:dataTable>
                    <p:panelGrid id="infEmisiones" columns="1" styleClass="noBorder" style="width: 100%;">
                        <p:row>
                            <p:column>
                                <p:outputLabel value="Valor a Cobrar: " style="font-size: 14px; font-weight: bolder;"/>
                                <p:outputLabel value="#{recaudacionPredialMB.totalEmisiones}" style="font-size: 14px; font-weight: bolder; color: blue;"/>
                            </p:column>
                            <p:spacer width="5%"/>
                            <p:column>
                                <p:outputLabel value="Saldo: " style="font-size: 14px; font-weight: bolder;"/>
                                <p:outputLabel value="#{recaudacionPredialMB.modelPago.valorSaldoPagoFinal}" style="font-size: 14px; font-weight: bolder; color: blue;"/>
                            </p:column>
                        </p:row>
                    </p:panelGrid>
                </p:fieldset>

                <p:fieldset legend="Detalle de Cobro">
                    <p:panelGrid id="detCobro" styleClass="noBorder">
                        <p:row>
                            <p:column>
                                <p:outputLabel value="Contado" style="font-weight: bolder;font-size: 9px"/>
                            </p:column>
                            <p:column>
                                <p:inputText value="#{recaudacionPredialMB.modelPago.valorTotalEfectivo}" readonly="true" size="8" style="font-weight: bolder; font-size: 9px;"/>
                            </p:column>
                            <p:column rowspan="6">
                                <p:panelGrid columns="2">
                                    <p:selectBooleanCheckbox value="#{recaudacionPredialMB.variosPagos}"
                                                             style="font-weight: bold; font-size: 14px;"/>
                                    <p:outputLabel value="***VARIOS PAGOS***" style="font-weight: bold; font-size: 14px;" />
                                </p:panelGrid>
                                <p:tabView>
                                    <p:tab title="1. EFECTIVO">
                                        <p:panelGrid columns="2">
                                            <p:outputLabel value="Valor Recibido"/>
                                            <p:inputText type="number" value="#{recaudacionPredialMB.modelPago.valorRecibido}" style="font-weight: bolder; font-size: 12px;" >
                                                <p:ajax event="blur" listener="#{recaudacionPredialMB.modelPago.calcularEfectivo()}" update="formProcesar:detCobro, formProcesar:infEmisiones" process="@form"/>
                                            </p:inputText>
                                            <p:outputLabel value="Valor a Cobrar"/>
                                            <p:inputText type="number" value="#{recaudacionPredialMB.modelPago.valorCobrar}" style="font-weight: bolder; font-size: 12px;">
                                                <p:ajax event="blur" listener="#{recaudacionPredialMB.modelPago.calcularEfectivo()}" update="formProcesar:detCobro, formProcesar:infEmisiones" process="@all"/>
                                            </p:inputText>
                                            <p:outputLabel value="Cambio"/><p:inputText value="#{recaudacionPredialMB.modelPago.valorCambio}" readonly="true" style="font-weight: bolder; font-size: 12px;"/>
                                        </p:panelGrid>
                                    </p:tab>
                                    <p:tab title="2. NOTA DE CREDITO" >
                                        <p:panelGrid columns="1">
                                            <p:row>
                                                <p:column width="100">
                                                    <h:outputLabel value="Nota de Credito" class="DispBlock Wid100 FontBold"/>
                                                    <p:selectOneMenu id="not" value="#{recaudacionPredialMB.modelPago.nota}" effect="fade"
                                                                     converter="entityConverter" filter="true" filterMatchMode="contains"
                                                                     styleClass="selectWidth170">
                                                        <f:selectItem itemLabel="SELECCIONE" itemValue="#{null}" noSelectionOption="true"/>
                                                        <f:selectItems value="#{recaudacionPredialMB.listPagoNota}" var="n" itemLabel="#{n.id} - #{n.contribuyente.identificacion} - #{n.contribuyente.nombreCompleto}" itemValue="#{n}"/>
                                                        <p:ajax update ="valornotas ,valorsaldos" />
                                                    </p:selectOneMenu>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="# Total"/><br/>
                                                    <p:inputText  id ="valornotas" value="#{recaudacionPredialMB.modelPago.nota.valor}" readonly="true"/>
                                                </p:column>

                                                <p:column>
                                                    <p:outputLabel for="valorsaldos" value="# Saldo"/><br/>
                                                    <p:inputText id="valorsaldos"  value="#{recaudacionPredialMB.modelPago.nota.saldo}" readonly="true"/>
                                                </p:column>

                                                <p:column>
                                                    <p:outputLabel for="valordebitado" value="Valor"/><br/>
                                                    <p:inputText id ="valordebitado" type="number" value="#{recaudacionPredialMB.modelPago.valorDebitado}" onkeypress="validateFloatValueAndFocusNext(event, 'agregar_nota')" >
                                                        <p:ajax update="valorsaldos" />
                                                    </p:inputText>
                                                </p:column>

                                                <p:column>
                                                    <p:commandButton id = "agregar_nota" value="Agregar"
                                                                     actionListener="#{recaudacionPredialMB.modelPago.agregarPago(3)}"
                                                                     update="formProcesar:detCobro, formProcesar:infEmisiones"/>
                                                </p:column>
                                            </p:row>
                                        </p:panelGrid>
                                        <p:dataTable id="dtNC" var="nc" value="#{recaudacionPredialMB.modelPago.listPagoNota}" style="margin-bottom:0; width: 700px;">

                                            <p:column headerText="# Total"><h:outputText value="#{nc.valor}" /></p:column>
                                            <p:column headerText="# Saldo"><h:outputText value="#{nc.saldo}" /></p:column>
                                            <p:column headerText="Valor"><h:outputText value="#{nc.valorDebitado}" /></p:column>

                                            <p:column headerText="Acción">
                                                <p:commandButton value="Eliminar" actionListener="#{recaudacionPredialMB.modelPago.eliminarPagoNC(nc)}" update="formProcesar:detCobro, formProcesar:infEmisiones"/>
                                            </p:column>
                                        </p:dataTable>
                                    </p:tab>
                                    <p:tab title="3. CHEQUE" >

                                        <p:panelGrid columns="1">
                                            <p:row>
                                                <p:column>
                                                    <p:outputLabel value="Banco"/><br/>
                                                    <p:selectOneMenu value="#{recaudacionPredialMB.modelPago.pagoCheque.banco}" effect="fade" converter="entityConverter">
                                                        <f:attribute name="name" value="RenEntidadBancaria"/>
                                                        <f:selectItem itemLabel="Seleccionar..." itemValue="#{null}"/>
                                                        <f:selectItems value="#{recaudacionPredialMB.bancos}" var="banco" itemLabel="#{banco.nombreBanco}" itemValue="#{banco}"/>
                                                    </p:selectOneMenu>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="# Cheque"/><br/>
                                                    <p:inputText value="#{recaudacionPredialMB.modelPago.pagoCheque.numCheque}"/>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="# Cuenta"/><br/>
                                                    <p:inputText value="#{recaudacionPredialMB.modelPago.pagoCheque.numCuenta}"/>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="# Valor"/><br/>
                                                    <p:inputText value="#{recaudacionPredialMB.modelPago.pagoCheque.valor}"/>
                                                </p:column>
                                                <p:column>
                                                    <p:commandButton value="Agregar" actionListener="#{recaudacionPredialMB.modelPago.agregarPago(4)}" update="formProcesar:detCobro, formProcesar:infEmisiones"/>
                                                </p:column>
                                            </p:row>
                                        </p:panelGrid>
                                        <p:dataTable id="dtCh" var="ch" value="#{recaudacionPredialMB.modelPago.listPagoCheque}" style="margin-bottom:0; width: 700px;">
                                            <p:column headerText="BANCO"><h:outputText value="#{ch.banco.nombreBanco}" /></p:column>
                                            <p:column headerText="# Cheque"><h:outputText value="#{ch.numCheque}" /></p:column>
                                            <p:column headerText="# Cuenta"><h:outputText value="#{ch.numCuenta}" /></p:column>
                                            <p:column headerText="# Valor"><h:outputText value="#{ch.valor}" /></p:column>
                                            <p:column headerText="Acción">
                                                <p:commandButton value="Eliminar" actionListener="#{recaudacionPredialMB.modelPago.eliminarPagoCh(ch)}" update="formProcesar:detCobro, formProcesar:infEmisiones"/>
                                            </p:column>
                                        </p:dataTable>

                                    </p:tab>
                                    <p:tab title="4. TARJETA DE CREDITO">
                                        <p:panelGrid columns="1">
                                            <p:row>
                                                <p:column>
                                                    <p:outputLabel value="Banco"/><br/>
                                                    <p:selectOneMenu value="#{recaudacionPredialMB.modelPago.pagoTarjetaCredito.banco}" effect="fade" converter="entityConverter">
                                                        <f:attribute name="name" value="RenEntidadBancaria"/>
                                                        <f:selectItem itemLabel="Seleccionar..." itemValue="#{null}"/>
                                                        <f:selectItems value="#{recaudacionPredialMB.tarjetas}" var="card" itemLabel="#{card.nombreBanco}" itemValue="#{card}"/>
                                                    </p:selectOneMenu>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="# Tarjeta"/><br/>
                                                    <p:inputText value="#{recaudacionPredialMB.modelPago.pagoTarjetaCredito.numTarjeta}" size="14"/>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="Fecha Caduca"/><br/>
                                                    <p:calendar value="#{recaudacionPredialMB.modelPago.pagoTarjetaCredito.fechaCaducidad}" pattern="dd/MM/yyyy" size="10"/>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="Autorización"/><br/>
                                                    <p:inputText value="#{recaudacionPredialMB.modelPago.pagoTarjetaCredito.autorizacion}" size="14"/>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="Baucher"/><br/>
                                                    <p:inputText value="#{recaudacionPredialMB.modelPago.pagoTarjetaCredito.baucher}" size="14"/>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="Titular"/><br/>
                                                    <p:inputText value="#{recaudacionPredialMB.modelPago.pagoTarjetaCredito.nombreTitular}" size="14"/>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="Valor"/><br/>
                                                    <p:inputText type="number" value="#{recaudacionPredialMB.modelPago.pagoTarjetaCredito.valor}" style="width:90px; "/>
                                                </p:column>
                                                <p:column>
                                                    <br/>
                                                    <p:commandButton value="Agregar" actionListener="#{recaudacionPredialMB.modelPago.agregarPago(2)}" update="formProcesar:detCobro, formProcesar:infEmisiones"/>
                                                </p:column>
                                            </p:row>
                                        </p:panelGrid>
                                        <p:dataTable id="dtTC" var="tc" value="#{recaudacionPredialMB.modelPago.listPagoTarjetaCredito}" style="margin-bottom:0; width: 700px;">
                                            <p:column headerText="BANCO"><h:outputText value="#{tc.banco.nombreBanco}" /></p:column>
                                            <p:column headerText="# Tarjeta"><h:outputText value="#{tc.numTarjeta}" /></p:column>
                                            <p:column headerText="Fecha Caducidad"><h:outputText value="#{tc.fechaCaducidad}"><f:convertDateTime pattern="dd/MM/YYYY"/></h:outputText></p:column>
                                            <p:column headerText="# Autorización"><h:outputText value="#{tc.autorizacion}" /></p:column>
                                            <p:column headerText="Baucher"><h:outputText value="#{tc.baucher}" /></p:column>
                                            <p:column headerText="Titular"><h:outputText value="#{tc.nombreTitular}" /></p:column>
                                            <p:column headerText="Valor"><h:outputText value="#{tc.valor}" /></p:column>
                                            <p:column headerText="Acción">
                                                <p:commandButton value="Eliminar" actionListener="#{recaudacionPredialMB.modelPago.eliminarPagoTC(tc)}" update="formProcesar:detCobro, formProcesar:infEmisiones"/>
                                            </p:column>
                                        </p:dataTable>
                                    </p:tab>
                                    <p:tab title="5. TRANSFERENCIA">
                                        <p:panelGrid columns="1">
                                            <p:row>
                                                <p:column>
                                                    <p:outputLabel value="Banco"/><br/>
                                                    <p:selectOneMenu value="#{recaudacionPredialMB.modelPago.pagoTransferencia.banco}" effect="fade" converter="entityConverter">
                                                        <f:attribute name="name" value="RenEntidadBancaria"/>
                                                        <f:selectItem itemLabel="Seleccionar..." itemValue="#{null}"/>
                                                        <f:selectItems value="#{recaudacionPredialMB.bancos}" var="banco" itemLabel="#{banco.nombreBanco}" itemValue="#{banco}"/>
                                                    </p:selectOneMenu>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="# Transferencia"/><br/>
                                                    <p:inputText value="#{recaudacionPredialMB.modelPago.pagoTransferencia.numTransferencia}"/>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="Fecha"/><br/>
                                                    <p:calendar value="#{recaudacionPredialMB.modelPago.pagoTransferencia.fecha}" pattern="dd/MM/yyyy" rendered="true"/>
                                                    <p:calendar value="#{recaudacionPredialMB.modelPago.pagoTransferencia.fecha}" pattern="dd/MM/yyyy" rendered="false">
                                                        <p:ajax event="dateSelect" listener="#{recaudacionPredialMB.actualizarValorPago}" update="formProcesar:infEmisiones"/>
                                                    </p:calendar>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel value="Valor"/><br/>
                                                    <p:inputText type="number" value="#{recaudacionPredialMB.modelPago.pagoTransferencia.valor}"/>
                                                </p:column>
                                                <p:column>
                                                    <p:commandButton value="Agregar" actionListener="#{recaudacionPredialMB.modelPago.agregarPago(5)}" update="formProcesar:detCobro, formProcesar:infEmisiones"/>
                                                </p:column>
                                            </p:row>
                                        </p:panelGrid>
                                        <p:dataTable id="dtT" var="t" value="#{recaudacionPredialMB.modelPago.listPagoTransferencia}" style="margin-bottom:0; width: 700px;">
                                            <p:column headerText="Banco"><h:outputText value="#{t.banco.descripcion}" /></p:column>
                                            <p:column headerText="# Transferencia"><h:outputText value="#{t.numTransferencia}" /></p:column>
                                            <p:column headerText="Fecha"><h:outputText value="#{t.fecha}"><f:convertDateTime pattern="dd/MM/YYYY"/></h:outputText></p:column>
                                            <p:column headerText="Valor"><h:outputText value="#{t.valor}" /></p:column>
                                            <p:column headerText="Acción">
                                                <p:commandButton value="Eliminar" actionListener="#{recaudacionPredialMB.modelPago.eliminarPagoTransferencia(t)}" update="formProcesar:detCobro, formProcesar:infEmisiones"/>
                                            </p:column>
                                        </p:dataTable>
                                    </p:tab>
                                    <p:tab title="6. CRUCE DE CUENTAS">
                                        <p:panelGrid columns="1">
                                            <p:outputLabel value="Valor a Cobrar"/>
                                            <p:inputText type="number" value="#{recaudacionPredialMB.modelPago.valorTotalCruceCuenta}" style="font-weight: bolder; font-size: 12px;">
                                                <p:ajax event="blur" listener="#{recaudacionPredialMB.modelPago.calcularCruceCuenta()}" update="formProcesar:detCobro, formProcesar:infEmisiones" process="@all"/>
                                            </p:inputText>
                                        </p:panelGrid>
                                    </p:tab>
                                </p:tabView>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="Notas Credito" style="font-weight: bolder;"/></p:column>
                            <p:column><p:inputText value="#{recaudacionPredialMB.modelPago.valorTotalNotasCredito}" readonly="true" size="8" style="font-weight: bolder; font-size: 9px;"/></p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="Cheque" style="font-weight: bolder;"/></p:column>
                            <p:column><p:inputText value="#{recaudacionPredialMB.modelPago.valorTotalCheques}" readonly="true" size="8" style="font-weight: bolder; font-size: 9px;"/></p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="Tarjeta" style="font-weight: bolder;"/></p:column>
                            <p:column><p:inputText value="#{recaudacionPredialMB.modelPago.valorTotalTarjetas}" readonly="true" size="8" style="font-weight: bolder; font-size: 9px;"/></p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="Transferencia" style="font-weight: bolder;"/></p:column>
                            <p:column><p:inputText value="#{recaudacionPredialMB.modelPago.valorTotalTransferencias}" readonly="true" size="8" style="font-weight: bolder; font-size: 9px;"/></p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="Cruce de Cuentas" style="font-weight: bolder;"/></p:column>
                            <p:column><p:inputText value="#{recaudacionPredialMB.modelPago.valorTotalCruceCuenta}" readonly="true" size="8" style="font-weight: bolder; font-size: 9px;"/></p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="Total" style="font-weight: bolder;"/></p:column>
                            <p:column><p:inputText value="#{recaudacionPredialMB.modelPago.valorTotal}" readonly="true" size="8" style="font-weight: bolder; font-size: 9px; color: red;"/></p:column>
                        </p:row>
                    </p:panelGrid>
                </p:fieldset>
                <p:panel id="botones">
                    <center>
                        <p:commandButton value="Procesar" styleClass="btnStyle" actionListener="#{recaudacionPredialMB.realizarPago}" icon="fa fa-check-circle"
                                         style="text-align: center" rendered="#{!recaudacionPredialMB.pagoRealizado and !recaudacionPredialMB.esPagoCuota}"
                                         update="mainForm" oncomplete="PF('dlgProcesar').hide();" process="@form" />
                        <!--                        <p:commandButton value="Procesar" styleClass="btnStyle" actionListener="# {recaudacionPredialMB.realizarPagoCuotas}" icon="fa fa-check"
                                                                 style="text-align: center" rendered="# {!recaudacionPredialMB.pagoRealizado and recaudacionPredialMB.esPagoCuota}" update="mainForm" oncomplete="PF('dlgProcesar').hide();" />-->
                        <p:spacer width="25"/>
                        <p:commandButton value="Cancelar" style="text-align: center" styleClass="btnStyle" oncomplete="PF('dlgProcesar').hide();" icon="fa fa-close"/>
                    </center>
                </p:panel>
                <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                    <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                    <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                </p:confirmDialog>
            </h:form>
        </p:dialog>

    </ui:define>

</ui:composition>
