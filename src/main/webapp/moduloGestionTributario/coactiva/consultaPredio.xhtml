<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/WEB-INF/template/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:dialog="http://xmlns.jcp.org/jsf/composite/dialog">
    <ui:define name="title">
        CONSULTA DE PREDIOS URBANOS Y RURALES
    </ui:define>
    <ui:param name="tittle" value="Consulta de Predios Urbano / Rural" />
    <ui:define name="content">
        <h:form id="mainForm">
            <div class="ui-g">
                <div class="ui-g-12">
                    <div class="ui-g-6">
                        <p:fieldset legend="Consulta de Predios" id="criterioBusquedad">
                            <div class="ui-g-12">
                                <center>
                                    <p:selectOneRadio  value="#{consultaPrediosMB.opcionBusquedad}" unselectable="true">
                                        <f:selectItem itemLabel="URBANO" itemValue="U"/>
                                        <f:selectItem itemLabel="RURAL" itemValue="R"/>
                                        <f:selectItem itemLabel="LOCAL COMERCIAL" itemValue="L"/>
                                        <p:ajax update="criterioBusquedad"/>
                                    </p:selectOneRadio>
                                </center>
                            </div>
                            <p:panelGrid style="width: 100%;" styleClass="form-group ui-panelgrid-blank" rendered="#{consultaPrediosMB.opcionBusquedad eq 'U' or consultaPrediosMB.opcionBusquedad eq 'L'}">
                                <p:row styleClass="ui-responsive">
                                    <p:column><p:outputLabel value="PARROQUIA " style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="SECTOR " style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="MANZANA " style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="SOLAR " style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="Div1" style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="Div2" style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="Div3" style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="Div4" style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="PHV " style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="PHH" style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column rendered="#{consultaPrediosMB.opcionBusquedad eq 'L'}"><p:outputLabel value="LOCAL" style="font-size: 13px; font-weight: bolder;"/></p:column>
                                </p:row>
                                <p:row styleClass="ui-responsive">
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.predio.parroquia}" placeholder="0" maxlength="1" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"  />
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.predio.sector}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.predio.mz}"  placeholder="0" maxlength="3" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.predio.solar}"  placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.div1}"  placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.div2}"  placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.div3}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.div4}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.predio.bloque}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{consultaPrediosMB.predio.piso}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column rendered="#{consultaPrediosMB.opcionBusquedad eq 'L'}">
                                        <p:inputText value="#{consultaPrediosMB.local}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 90%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                            <p:panelGrid style="width: 100%;" styleClass="form-group ui-panelgrid-blank" rendered="#{consultaPrediosMB.opcionBusquedad eq 'R'}">
                                <p:row styleClass="ui-responsive">
                                    <p:column><p:outputLabel value="PARROQUIA" style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="SECTOR " style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="CODIGO " style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="Div1" style="font-size: 13px; font-weight: bolder;"/></p:column>
                                    <p:column><p:outputLabel value="Div2" style="font-size: 13px; font-weight: bolder;"/></p:column>
                                </p:row>
                                <p:row styleClass="ui-responsive">
                                    <p:column><!--parroquia-->
                                        <p:inputText value="#{consultaPrediosMB.predio.parroquia}" placeholder="0" maxlength="1" style="font-size: 13px; font-weight: bolder; width: 50%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"  />
                                        </p:inputText>
                                    </p:column>
                                    <p:column><!--sector-->
                                        <p:inputText value="#{consultaPrediosMB.predio.sector}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 50%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column><!--CODIGO-->
                                        <p:inputText value="#{consultaPrediosMB.div3}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 50%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column><!--div1-->
                                        <p:inputText value="#{consultaPrediosMB.div1}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 50%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column><!--div2-->
                                        <p:inputText value="#{consultaPrediosMB.div2}" placeholder="0" maxlength="2" style="font-size: 13px; font-weight: bolder; width: 50%;">
                                            <p:keyFilter preventPaste="false" regEx="[0-9]"/>
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                            <center>
                                <p:commandButton rendered="#{consultaPrediosMB.opcionBusquedad eq 'U' or consultaPrediosMB.opcionBusquedad eq 'L'}" value="CONSULTAR" style="font-size: 15px; font-weight: bolder; margin: 15px" styleClass="btnStyle" 
                                                 actionListener="#{consultaPrediosMB.formandoClaveCatastra(9)}"
                                                 icon="ui-icon-search" iconPos="right" update="dtPredios"/>
                                <p:commandButton rendered="#{consultaPrediosMB.opcionBusquedad eq 'R'}" value="CONSULTAR" style="font-size: 15px; font-weight: bolder; margin: 15px" styleClass="btnStyle" actionListener="#{consultaPrediosMB.formandoClaveCatastra(4)}"
                                                 icon="ui-icon-search" iconPos="right" update="dtPredios"/>
                            </center>
                        </p:fieldset>
                    </div>
                    <div class="ui-g-6">
                        <p:fieldset  legend="Foto del predio" id="fotoPredio" widgetVar="fotoPredio">
                            <center>
                                <p:graphicImage rendered="#{consultaPrediosMB.urlConmpleta ne null}"
                                                value="#{consultaPrediosMB.urlConmpleta}" width="200" height="200" />
                            </center>
                        </p:fieldset>
                    </div>
                    <div class="ui-g-12">
                        <p:dataTable id="dtPredios" value="#{consultaPrediosMB.listaPredios}" var="predio"  paginator="true" rows="10" paginatorPosition="bottom" 
                                     emptyMessage="Sin elementos..." scrollable="true"  style="text-align: center;">
                            <f:facet name="header">Listado de Predios</f:facet>
                            <p:column headerText="Clave Catastral" width="100"><p:outputLabel value="#{predio.claveCat}"/></p:column>
                            <p:column headerText="Propietarios" width="100"><p:outputLabel value="#{predio.nombrePropietarios}"/></p:column>
                            <p:column headerText="Direccion" width="100"><p:outputLabel value="#{predio.direccion}"/></p:column>
                            <p:column headerText="Acción" width="100">
                                <p:commandButton title="Ver Detalles" icon="fa fa-eye" actionListener="#{consultaPrediosMB.predioSeleccionado(predio)}" update="dlgPredio" oncomplete="PF('dlgPredio').show()" />
                            </p:column>
                        </p:dataTable>
                    </div>
                </div>
            </div>  
        </h:form>
        <!--DETALLE DEL JUICIO-->   
        <p:dialog header="Detalle del predio" widgetVar="dlgPredio" id="dlgPredio" resizable="false" closeOnEscape="true" modal="true" width="80%" height="100%" position="center">
            <h:form id="formInformCoa">
                <p:tabView>
                    <p:tab  title="DATOS DEL PREDIO" >
                        <p:panelGrid styleClass="ui-panelgrid-blank" style="width: 100%" columns="2" layout="grid" columnClasses="ui-g-6,ui-g-6">
                            <p:panelGrid styleClass="ui-panelgrid-blank" style="width: 100%" columns="3" layout="grid" columnClasses="ui-g-4,ui-g-4,ui-g-4">
                                <p:panelGrid columns="1" styleClass="ui-g-12">
                                    <p:outputLabel value="Clave del predio" style="font-size: 15px"></p:outputLabel>
                                    <p:inputText value="#{consultaPrediosMB.predio.claveCat}" readonly="true"/>
                                </p:panelGrid>
                                <p:panelGrid columns="1" styleClass="ui-g-12">
                                    <p:outputLabel value="Propietario" style="font-size: 15px"></p:outputLabel>
                                    <p:inputText value="#{consultaPrediosMB.predio.nombrePropietarios}" readonly="true" style="width: auto"/>
                                </p:panelGrid>
                                <p:panelGrid columns="1" styleClass="ui-g-12">
                                    <p:outputLabel value="Direccion:" style="font-size: 15px"></p:outputLabel>
                                    <p:inputText value="#{consultaPrediosMB.predio.direccion}" style="width: auto" readonly="true"/>
                                </p:panelGrid>
                                <p:panelGrid columns="1" styleClass="ui-g-12">
                                    <p:outputLabel value="Ciudadela:" style="font-size: 15px"></p:outputLabel>
                                    <p:inputText value="#{consultaPrediosMB.predio.ciudadela.nombre}" readonly="true"/>
                                </p:panelGrid>
                                <p:panelGrid columns="1" styleClass="ui-g-12">
                                    <p:outputLabel value="Estado:" style="font-size: 15px"></p:outputLabel>
                                    <p:inputText value="#{consultaPrediosMB.predio.estado eq 'A' ?'ACTIVA':'INACTIVO'}" readonly="true" />
                                </p:panelGrid>
                                <p:panelGrid columns="1" styleClass="ui-g-12">
                                    <p:outputLabel value="Tipo de predio" style="font-size: 15px"></p:outputLabel>
                                    <p:inputText value="#{consultaPrediosMB.predio.tipoPredio eq 'U'?'URBANO':'RURAL'}" readonly="true" />
                                </p:panelGrid>
                                 <p:panelGrid columns="1" styleClass="ui-g-12">
                                    <p:outputLabel value="Nº de Local" style="font-size: 15px"></p:outputLabel>
                                    <p:inputText value="#{consultaPrediosMB.localComercial.numLocal}" readonly="true" />
                                </p:panelGrid>
                                <p:panelGrid columns="1" styleClass="ui-g-12">
                                    <p:outputLabel value="Nombre Local" style="font-size: 15px"></p:outputLabel>
                                    <p:inputText value="#{consultaPrediosMB.localComercial.nombreLocal}" readonly="true" />
                                </p:panelGrid>
                            </p:panelGrid>
                            <p:panelGrid columns="1" style="width: 100%; align-items: center; align-content: center " layout="grid" columnClasses="ui-g-12" >
                                <p:fieldset legend="Imagen Predio">
                                    <center>
                                        <p:graphicImage value="#{consultaPrediosMB.urlConmpleta}" width="200" height="200" />
                                    </center>
                                </p:fieldset>
                            </p:panelGrid>
                        </p:panelGrid>
                    </p:tab>
                    <p:tab title="Antecedente Judiciales">
                        <p:dataTable value="#{consultaPrediosMB.juicios}" emptyMessage="Sin elementos..." var="antecedentes" scrollable="true" paginator="true" rows="10" paginatorPosition="bottom"
                                     style="text-align: center;width: 99%; margin: 5px">
                            <f:facet name="header">Antecedentes Judiciales</f:facet>
                            <p:column headerText="Proceso" width="100"><p:outputLabel value="#{antecedentes.codigoJuicio}"/></p:column>
                            <p:column headerText="Estado del Juicio" width="100"><p:outputLabel value="#{antecedentes.estadoJuicio.descripcion}"/></p:column> 
                            <p:column headerText="Años" width="100"><p:outputLabel value="#{antecedentes.anioJuicio}"/></p:column>
                            <p:column headerText="Fecha Proceso" width="100"><p:outputLabel value="#{antecedentes.fechaJuicio}"/></p:column>
                            <p:column headerText="Abogado" width="100"><p:outputLabel value="#{antecedentes.abogadoJuicio.detalle}"/></p:column>
                            <p:column headerText="Total Deuda" width="100"><p:outputLabel value="#{antecedentes.totalDeuda}"/></p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Historial de Pago">
                        <p:dataTable value="#{consultaPrediosMB.historialPagos}" emptyMessage="Sin elementos..." var="historial" scrollable="true" 
                                     rows="10" style="text-align: center;width: 99%; margin: 5px">
                            <f:facet name="header">Historial de Pagos</f:facet>
                            <p:column headerText="Predio" width="100"><p:outputLabel value="#{historial.predio.claveCat}"/></p:column>
                            <p:column headerText="Año" width="100"><p:outputLabel value="#{historial.anio}"/></p:column>
                            <p:column headerText="Total Pagar" width="100"><p:outputLabel value="#{historial.totalPago}"/></p:column>
                            <p:column headerText="Estado" width="100"><p:outputLabel value="#{historial.estadoLiquidacion.descripcion}"/></p:column>
                            <p:column headerText="opciones" width="100">
                                <p:commandButton title="Ver Detalle" icon="fa fa-eye" actionListener="#{consultaPrediosMB.capturarLiquidacionDetalle(historial)}"
                                                 update="dlgDetalle" oncomplete="PF('dlgDetalle').show()"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                </p:tabView>
            </h:form>
        </p:dialog>
        <!--COMPONENTE DETALLE-->
        <p:dialog header="Detalle Emision" widgetVar="dlgDetalle" id="dlgDetalle" resizable="false"
                  closeOnEscape="true" modal="true" width="50%" position="center">
            <h:form id="formDetEmision">
                <dialog:detalleLiquidacion liquidacion="#{consultaPrediosMB.liquidacionSeleccionada}"/>
                <center><p:commandButton style="margin: 10px" value="Aceptar" oncomplete="PF('dlgDetalle').hide();" styleClass="btnStyle"/></center>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>