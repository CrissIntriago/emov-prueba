<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:poue="http://primefaces.org/ui/extensions"
                xmlns:dlg="http://xmlns.jcp.org/jsf/composite/dialog"
                xmlns:comp="http://xmlns.jcp.org/jsf/composite/comp"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <ui:param name="tittle" value="PATENTES" />
    <ui:define name="head">
        <style type="text/css">
            .ui-datepicker .ui-datepicker-title select {
                font-size: 1em;
                margin: 1px 0;
                color: black;
            }
            h1{
                color:white;
            }
        </style>
    </ui:define>
    <ui:define name="content">
        <div class="ui-g ui-fluid">
            <div class="ui-g-12">
                <h:form id="frmMain" >
                    <center>
                        <p:tabView id="tabViewPatentes">
                            <p:tab title="Listado de patentes">
                                <div style="text-align: left">
                                    <p:commandButton icon="fa fa-plus" value="Nueva Patente" style="width: auto;" styleClass="btnStyle"
                                                     actionListener="#{patenteView.nuevaPatente()}"/>
                                    <p:spacer width="10"/>
                                    <p:commandButton icon="fa fa-refresh" value="Actualizar" style="width: auto;" styleClass="btnStyle"
                                                     actionListener="#{patenteView.init()}" update="frmMain"/> 
                                </div> 
                                <br/><br/>
                                <p:dataTable id="dtPatentes" lazy="true" value="#{patenteView.patentes}"
                                             var="patente" rows="20" paginator="true" paginatorPosition="top"
                                             emptyMessage="No existen patentes registradas" rowIndexVar="patIndex"
                                             rowsPerPageTemplate="10, 20, 50, 100" filterEvent="enter" widgetVar="dtPatentes" >

                                    <p:ajax event="rowToggle" update="dtLocales" listener="#{patenteView.executarLocales(patente)}"/>
                                    <p:column style="width:2rem">
                                        <p:rowToggler>

                                        </p:rowToggler>
                                    </p:column>
                                    <p:column headerText="RUC" filterBy="#{patente.propietario.identificacionCompleta}" width="12%;" filterStyle="width:70%;">
                                        <center><h:outputText value="#{patente.propietario.identificacionCompleta}"/></center>
                                    </p:column>
                                    <p:column headerText="Contribuyente" filterBy="#{patente.propietario.apellido}" width="30%;">
                                        <h:outputText value="#{patente.propietario.apellido} #{patente.propietario.nombre}"  style="text-transform: uppercase;"/>
                                    </p:column>
                                  
                                    <p:column headerText="Actividad Comercial" width="24%;">
                                        <center>
                                            <h:outputText value="#{patente.actividadPrincipal.descripcion}" style="text-transform: uppercase; font-size: 11px"/>

                                        </center>
                                    </p:column>


                                    <p:column headerText="Estado" width="24%;">
                                        <center>
                                            <h:outputText value="#{patente.estado eq null?'Inactivo':(patente.estado eq true?'Activo':'Inactivo')}"/>

                                        </center>
                                    </p:column>
                                    <p:column headerText="Acción" width="15%;">
                                        <center>
                                            <p:commandLink rendered="false" title="Informacion" actionListener="#{patenteView.viewPatente(patente, false )}" styleClass="btnStyle">
                                                <i class="fa fa-fw fa-file-text" style="font-size: 1.5em"></i>
                                            </p:commandLink>
                                            <p:spacer width="2"/>
                                            <p:commandLink title="Editar" actionListener="#{patenteView.editarPatente(patente, true)}" styleClass="btnStyle">
                                                <i class="fa fa-fw fa-edit" style="font-size: 1.5em"></i>
                                            </p:commandLink>
                                            <p:spacer width="2"/>
                                            <p:commandLink title="Inhabilitar" actionListener="#{patenteView.eliminarPatente(patente)}" process="@this" update="frmMain,dtPatentes"
                                                           styleClass="btnStyle">
                                                <i class="fa fa-fw fa-trash" style="font-size: 1.5em"></i>
                                                <p:confirm header="Confirmación" message="Estaa Seguro de Eliminar esta Patente" icon="ui-icon-alert" />
                                            </p:commandLink>
                                            <p:commandLink title="Ver liquidaciones" actionListener="#{patenteView.verLiquidaciones(patente.renLocalComercialList)}"
                                                           update="frmMain" styleClass="btnStyle" >
                                                <i class="fa fa-fw fa-eye" style="font-size: 1.5em"></i>
                                            </p:commandLink>



                                        </center>
                                    </p:column>
                                    <p:rowExpansion >
                                        <p:dataTable id="dtLocales"  
                                                     value="#{patenteView.localesLista}" 
                                                     style="width: 100%;"
                                                     var="local" rows="5" 
                                                     paginator="true" paginatorPosition="bottom"
                                                     currentPageReportTemplate="Mostrando {startRecord}-{endRecord} de {totalRecords}"
                                                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                     widgetVar="dtLocales">
                                            <f:facet name="header">
                                                LISTADO DE LOCALES
                                            </f:facet>


                                            <p:column headerText="RUC" filterBy="#{local.propietario.identificacionCompleta}" width="15%;" filterStyle="width:70%;">
                                                <center><h:outputText value="#{local.propietario.identificacionCompleta}"/></center>
                                            </p:column>

                                            <p:column headerText="Clave Predial" filterBy="#{local.clavePreial}" width="15%;" filterStyle="width:70%;">
                                                <center><h:outputText value="#{local.clavePreial}"/></center>
                                            </p:column>

                                            <p:column headerText="Num Local" filterBy="#{local.numLocal}" width="15%;" filterStyle="width:70%;">
                                                <center><h:outputText value="#{local.numLocal}"/></center>
                                            </p:column>

                                            <p:column headerText="Tipo Predio" filterBy="#{local.tipoPredio}" width="15%;" filterStyle="width:70%;">
                                                <center><h:outputText value="#{local.tipoPredio}"/></center>
                                            </p:column>

                                            <p:column headerText="Nombre Local" width="40%;" filterBy="#{local.nombreLocal}">
                                                <h:outputText value="#{local.nombreLocal}" />

                                            </p:column>

                                            <p:column headerText="Contribuyente" width="40%;" filterBy="#{local.patente.propietario.nombreCompleto}">
                                                <h:outputText value="#{local.patente.propietario.nombreCompleto}" />

                                            </p:column>
                                          

                                            <p:column headerText="LLeva Contabilitdad" width="10%;" filterBy="#{local.patente.contabilidad}" style="text-align: center;">
                                                <f:facet name="filter">
                                                    <p:selectOneMenu onchange="PF('dtLocales').filter()" styleClass="custom-filter">
                                                        <f:converter converterId="javax.faces.Boolean" />
                                                        <f:selectItem itemLabel="Todos" itemValue=""/>
                                                        <f:selectItem itemLabel="SI" itemValue="true" />
                                                        <f:selectItem itemLabel="NO" itemValue="false" />
                                                    </p:selectOneMenu>
                                                </f:facet>
                                                <h:outputText value="#{local.patente.contabilidad?'SI':'NO'}"/>
                                            </p:column>
                                            <p:column headerText="Nombre Local" filterBy="#{local.nombreLocal}" width="15%;">
                                                <h:outputText value="#{local.nombreLocal}" style="margin-left: 15px;"/>
                                            </p:column>
                                            <p:column headerText="Acción" width="10%;">
                                                <center>
                                                    <p:commandLink title="Memo" actionListener="#{patenteView.openMemo(local)}"
                                                                   update="frmMain" styleClass="btnStyle" >
                                                        <i class="fa fa-print" style="font-size: 1.5em"></i>
                                                    </p:commandLink>

                                                    <p:commandLink title="Historial Actividades Locales" oncomplete="PF('dlgoHiLocales').show()" update="frmLocalActividesHi"
                                                                   actionListener="#{patenteView.historiLocaes(local)}"
                                                                   styleClass="btnStyle" >
                                                        <i class="fa fa-book" style="font-size: 1.5em"></i>
                                                    </p:commandLink>

                                                </center>
                                            </p:column>
                                        </p:dataTable>
                                    </p:rowExpansion>
                                </p:dataTable>
                            </p:tab>

                            <!-- -->

                            <p:tab title="Actividades Comerciales">
                                <p:panelGrid layout="grid" columns="1">
                                    <p:commandButton value="Nueva actividad" icon="fa fa-plus" onclick="PF('dlgAct').show()" style="float: right; width: auto; " 
                                                     actionListener="#{patenteView.initRegistroActividad()}" styleClass="btnStyle" update="frmAct"/>
                                </p:panelGrid>

                                <p:dataTable id="datActividades"
                                             value="#{patenteView.actividades}" var="cat1" rows="10"
                                             paginator="true"
                                             paginatorPosition="bottom"
                                             lazy="true">
                                    <p:column headerText="CIIU" width="20%">
                                        <h:outputText value="#{cat1.ciu}"/>
                                    </p:column>
                                    <p:column headerText="Descripción" width="100%" filterBy="#{cat1.descripcion}" filterStyle="width: 90%">
                                        <h:outputText value="#{cat1.descripcion}"/>
                                    </p:column>
                                    <p:column headerText="Valor" width="10%">
                                        <h:outputText value="#{cat1.valor}"/>
                                    </p:column>
                                    <p:column headerText="Acción" width="20%">
                                        <center>
                                            <p:commandLink title="Editar" actionListener="#{patenteView.initEditActividad(cat1)}" styleClass="btnStyle"
                                                           onclick="PF('dlgAct').show()" update="frmAct" >
                                                <i class="fa fa-fw fa-edit" style="font-size: 1.5em"></i>
                                            </p:commandLink>
                                            <p:spacer width="6S"/>
                                            <p:commandLink title="Eliminar" actionListener="#{patenteView.eliminarActividad(cat1)}" styleClass="btnStyle"
                                                           update="frmMain:tabViewPatentes:datActividades" >
                                                <i class="fa fa-fw fa-remove" style="font-size: 1.5em;color: red"></i>
                                            </p:commandLink>

                                        </center>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                        </p:tabView>
                    </center>
                </h:form>


                <p:dialog widgetVar="dlgoHiLocales" id="dlgoHiLocales" position="center" header="Historial de Actividad Comercial del local"    modal="true" width="50%" resizable="false"
                          closable="true" closeOnEscape="true">
                    <h:form id="frmLocalActividesHi" >

                        <p:commandButton value="Nuevo" icon="fa fa-plus" style="width: auto;" actionListener="#{patenteView.editHistorialActividades(null)}" 
                                         oncomplete="PF('dlgoHiLocalesEdit').show()" update="frmLocalActividesHiEdit"/>

                        <p:dataTable id="actividaesHisto" widgetVar="actividaesHisto" value="#{patenteView.lazyHiActividades}" var="hiLocal" rows="10"
                                     paginator="true" paginatorPosition="bottom" lazy="true">
                            <p:column headerText="Actividad Comercial" filterBy="#{hiLocal.actividad.descripcion}" filterMatchMode="contains" width="200">
                                <h:outputText value="#{hiLocal.actividad.descripcion}"/>
                            </p:column>

                            <p:column headerText="Año" filterBy="#{hiLocal.anio}" width="75">                                    
                                <h:outputText value="#{hiLocal.anio}"/>
                            </p:column>

                            <p:column headerText="*****" width="50">
                                <p:commandButton icon="fa fa-edit" actionListener="#{patenteView.editHistorialActividades(hiLocal)}" 
                                                 oncomplete="PF('dlgoHiLocalesEdit').show()" update="frmLocalActividesHiEdit"/>
                            </p:column>

                        </p:dataTable>
                    </h:form>
                </p:dialog>

                <p:dialog widgetVar="dlgoHiLocalesEdit" id="dlgoHiLocalesEdit" position="center" width="400" header="Formulario"    modal="true"  resizable="false"
                          closable="true" closeOnEscape="true">
                    <h:form id="frmLocalActividesHiEdit" >
                        <p:panelGrid layout="grid" columns="2" columnClasses="ui-g-8,ui-g-4" styleClass="ui-panelgrid-blank">
                            <p:panelGrid columns="1" style="width: 100%;">
                                <p:outputLabel value="Actividad" class="FontBold"/>
                                <p:selectOneMenu value="#{patenteView.historialActividades.actividad}" style="width: 100%;" converter="#{utilConverter}" filter="true" filterMatchMode="contains">
                                    <f:selectItem itemLabel="Seleccione" itemValue="#{null}"/>
                                    <f:selectItems value="#{patenteView.actividadList}" var="act" itemLabel="#{act.descripcion}" itemValue="#{act}"/>
                                </p:selectOneMenu>
                            </p:panelGrid>
                            <p:panelGrid columns="1" style="width: 100%;">
                                <p:outputLabel value="Año" class="FontBold"/>
                                <p:inputText value="#{patenteView.historialActividades.anio}"  readonly="#{patenteView.historialActividades ne null and patenteView.historialActividades.id ne null}" style="width: 100%;">
                                    <p:keyFilter mask="num" />
                                </p:inputText>
                            </p:panelGrid>
                        </p:panelGrid>
                        <center>
                            <p:commandButton icon="fa fa-save" value="Guardar" oncomplete="PF('dlgoHiLocalesEdit').hide()" update="frmLocalActividesHiEdit,frmLocalActividesHi"
                                             actionListener="#{patenteView.saveUpdateHiActividades()}" style="width: auto; margin-top: 10px;"/>
                        </center>
                    </h:form>
                </p:dialog>

                <p:dialog widgetVar="dlgAct" position="center" header="Ingreso de Actividad Comercial"
                          appendTo="@(body)" modal="true" width="50%" resizable="false"
                          closable="true" closeOnEscape="true">
                    <h:form id="frmAct">
                        <center>
                            <h:panelGrid columns="2" style="width: 100%;">
                                <h:panelGroup layout="block" class="Responsive100 Responsive">
                                    <p:outputLabel for="ciiu-form" value="CIIU:" class="DispBlock Wid100" style="font-weight: bolder !important; margin-bottom: 0px;" />
                                    <br></br>
                                    <p:inputText id="ciiu-form" value="#{patenteView.actividad.ciu}" styleClass="inputWidth90" style="width: 80%" readonly="false" required="false">
                                        <c:choose>
                                            <c:when test="true">
                                                <f:attribute name="onkeypress" value="validateIntegerValueAndFocusNext(event,'tdatos:frmCaracSolar:frt1:frt1-form')" />
                                            </c:when>
                                            <c:when test="false">
                                                <f:attribute name="onkeypress" value="validateFloatValueAndFocusNext(event,'tdatos:frmCaracSolar:frt1:frt1-form')" />
                                            </c:when>
                                            <c:when test="false">
                                                <f:attribute name="onkeypress" value="focusNextOnEnter(event,'tdatos:frmCaracSolar:frt1:frt1-form')" />
                                            </c:when>
                                            <c:otherwise>
                                                <f:attribute name="onkeypress" value="focusNextOnEnter(event,'tdatos:frmCaracSolar:frt1:frt1-form')" />
                                            </c:otherwise>
                                        </c:choose>
                                        <c:if test="false" >
                                            <f:convertNumber pattern="#" locale="us"/>
                                        </c:if>
                                        <c:if test="false" >
                                            <f:convertNumber type="currency" currencySymbol="" locale="en_US"/>
                                        </c:if>
                                        <c:if test="false" >
                                        </c:if>
                                    </p:inputText>
                                </h:panelGroup>
                                <h:panelGroup layout="block" class="Responsive100 Responsive">
                                    <p:outputLabel for="nivel_act-form" value="Nivel:" class="DispBlock Wid100" style="font-weight: bolder !important; margin-bottom: 0px;" />
                                    <br></br>
                                    <p:inputText id="nivel_act-form" value="#{patenteView.actividad.nivel}" styleClass="inputWidth90" style="width: 80%" readonly="true" required="false">
                                        <c:choose>
                                            <c:when test="true">
                                                <f:attribute name="onkeypress" value="validateIntegerValueAndFocusNext(event,'tdatos:frmCaracSolar:frt1:frt1-form')" />
                                            </c:when>
                                            <c:when test="true">
                                                <f:attribute name="onkeypress" value="validateFloatValueAndFocusNext(event,'tdatos:frmCaracSolar:frt1:frt1-form')" />
                                            </c:when>
                                            <c:when test="true">
                                                <f:attribute name="onkeypress" value="focusNextOnEnter(event,'tdatos:frmCaracSolar:frt1:frt1-form')" />
                                            </c:when>
                                            <c:otherwise>
                                                <f:attribute name="onkeypress" value="focusNextOnEnter(event,'tdatos:frmCaracSolar:frt1:frt1-form')" />
                                            </c:otherwise>
                                        </c:choose>
                                        <c:if test="r" >
                                            <f:convertNumber pattern="#" locale="us"/>
                                        </c:if>
                                        <c:if test="$}" >
                                            <f:convertNumber type="$" currencySymbol="" locale="en_US"/>
                                        </c:if>
                                        <c:if test="false" >
                                        </c:if>
                                    </p:inputText>
                                </h:panelGroup>

                                <h:panelGrid columns="1" style="width: 100%;">
                                    <h:panelGroup layout="block" class="Responsive100 Responsive">
                                        <p:outputLabel value="Descripción" for="act_descrip"  style="font-weight: bolder !important; margin-bottom: 0px;" /> <br/>
                                        <p:inputText id="act_descrip" value="#{patenteView.actividad.descripcion}" onkeypress="focusNextOnEnter(event, '')" style="width: 80% !important;"/>
                                    </h:panelGroup>
                                </h:panelGrid>

                                <h:panelGrid columns="1" style="width: 100%;">
                                    <h:panelGroup layout="block" class="Responsive100 Responsive">
                                        <p:outputLabel value="Valor"  style="font-weight: bolder !important; margin-bottom: 0px;" /> <br/>
                                        <p:inputText  value="#{patenteView.actividad.valor}" onkeypress="focusNextOnEnter(event, '')" style="width: 80% !important;">
                                            <p:keyFilter mask="num"/>
                                        </p:inputText>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </h:panelGrid>



                        </center>
                        <br/>
                        <center style="margin-top: 10px;">
                            <p:commandButton value="Guardar" icon="fa fa-save" actionListener="#{patenteView.guardarActividadComercial()}" styleClass="btnStyle" update=":frmMain" oncomplete="PF('dlgAct').hide()"/>
                            <p:spacer width="10"/>
                            <p:commandButton value="Cancelar" icon="fa fa-close" onclick="PF('dlgAct').hide()" styleClass="btnStyle"/>
                        </center>
                    </h:form>
                </p:dialog>


                <p:dialog widgetVar="dlogoNewPatente" position="center" header="Ingreso de Actividad Comercial"
                          appendTo="@(body)" modal="true" width="90%" resizable="false" id="dlogoNewPatente" height="600"
                          closable="true" closeOnEscape="true" >
                    <h:form id="frmNew" prependId="false" >

                        <center>
                            <h:panelGroup layout="block" id="wizarContainer"  class="Container Wid100 MarTop10" >
                                <h:panelGroup layout="block" class="Container90"  rendered="#{patenteView.patente.id gt 0 and patenteView.esEditable}">
                                    <h1>Ediciòn de Patentes</h1>
                                </h:panelGroup>
                                <h:panelGroup layout="block" class="Container90"  rendered="#{patenteView.patente.id gt 0 and !patenteView.esEditable}">
                                    <h1>Informaciòn de Patentes</h1>
                                </h:panelGroup>
                                <h:panelGroup layout="block" class="Container90"  rendered="#{patenteView.patente.id eq null}">
                                    <h1>Registro de Patentes</h1>
                                </h:panelGroup>
                            </h:panelGroup>
                        </center>
                        <p:panel>
                            <h:panelGroup layout="block" class="Wid100 Responsive100" >
                                <h:panelGroup layout="block" class="MarRight10 MarLeft10" id="wizarContainer1">
                                    <p:wizard id="wizardFlow" flowListener="#{patenteView.onFlowProcess}" nextLabel="Siguiente" backLabel="Anterior">
                                        <p:tab id="informacionPatente" title="Informaciòn de Patente" >
                                            <!--<ui:include src="_establecimientos.xhtml" /><div class="p-formgrid p-grid"> -->
                                            <ui:include src="_informacionPatente.xhtml" />
                                        </p:tab>
                                        <p:tab id="actvidadEconomica" title="Actividad Ecònomica Principal" rendered="#{patenteView.esEditable}">
                                            <ui:include src="_actividadesEconomicas.xhtml" />
                                        </p:tab>
                                        <p:tab id="establecimientos" title="Establecimientos" rendered="#{patenteView.esEditable}">
                                            <ui:include src="_establecimientos.xhtml" />
                                            <h:panelGroup layout="block" class="Wid100">
                                                <p:commandButton id="guardarPhs" immediate="true"
                                                                 icon="fa fa-save" action="#{patenteView.guardarPatente()}"
                                                                 value="Grabar Patente" style="float: right">
                                                    <p:confirm header="Confirmación" message="Cofirmación" icon="ui-icon-alert" />
                                                </p:commandButton>
                                                <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                                                    <h:panelGroup layout="block" class="Wid100 MarBot10">
                                                        <h:outputText value="Esta Seguro de Grabar Patente?" style="display:block; text-align: center; padding-bottom: 5px;" styleClass="FontBold"/>
                                                    </h:panelGroup>

                                                    <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                                    <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                                </p:confirmDialog>
                                            </h:panelGroup>
                                        </p:tab>
                                    </p:wizard>
                                </h:panelGroup>
                            </h:panelGroup>
                        </p:panel>
                    </h:form>
                </p:dialog>
                <p:dialog id="dlgContribuyentes" widgetVar="dlgContribuyentes" header="LISTADO DE CONTRIBUYENTES" appendTo="@(body)" 
                          width="50%" responsive="true" closable="true" 
                          closeOnEscape="true" modal="true" position="center">
                    <h:form id="frmContribuyentes">
                        <div align="center">
                            <p:dataTable id="dtContribuyente" value="#{patenteView.contribuyentes}" 
                                         var="s" selection="#{patenteView.propietario}" 
                                         rowKey="#{s.id}" style="width: 98%" lazy="true" reflow="true" paginator="true" rows="10" filterEvent="enter" paginatorPosition="top">
                                <p:ajax event="rowSelect" update="frmContribuyentes:btnSelectProp" />
                                <p:ajax event="rowUnselect"  update="frmContribuyentes:btnSelectProp" />
                                <p:ajax event="rowSelectRadio"  update="frmContribuyentes:btnSelectProp" />
                                <p:column headerText="*" selectionMode="single" style="width:5%" />
                                <p:column headerText="Identificacion" sortBy="#{s.identificacion}" filterBy="#{s.identificacionCompleta}" filterMatchMode="contains" filterStyle="width: 59%;" style="width: 15%;text-align:center">
                                    <h:outputText value="#{s.identificacionCompleta}"/>
                                </p:column>
                                <p:column headerText="Apellidos" sortBy="#{s.apellido}" filterBy="#{s.apellido}" filterMatchMode="contains" filterStyle="width: 59%;" style="width: 40%;text-align:center">
                                    <h:outputText value="#{s.apellido}"/>
                                </p:column>
                                <p:column headerText="Nombre" sortBy="#{s.nombre}" filterBy="#{s.nombre}" filterMatchMode="contains" filterStyle="width: 59%;" style="width: 40%;text-align:center">
                                    <h:outputText value="#{s.nombre}"/>
                                </p:column>
                                <!--                        <p:column headerText="Contribuyente" style="width: 60%;text-align:center">
                                                            <h:outputText value="#{s.nombreCompleto()}" style="text-transform: uppercase"/>
                                                        </p:column>-->
                            </p:dataTable>  
                        </div>
                        <center>
                            <p:commandButton disabled="#{patenteView.propietario.id eq null}" id="btnSelectProp" 
                                             actionListener="#{patenteView.seleccionarContribuyente()}" value="Seleccionar"  style="height: 30px; margin-top: 10px;" 
                                             update=":frmNew" />
                        </center>
                    </h:form>
                </p:dialog> 

                <p:dialog id="dlgPredios" widgetVar="dlgPredios" header="Listado de Predios" appendTo="@(body)" width="70%" responsive="true" 
                          closable="true" closeOnEscape="true" modal="true" position="center">
                    <h:form id="frmPredios">

                        <div align="center">
                            <p:dataTable id="dtPredios" lazy="true" value="#{patenteView.predioListLazy}" reflow="true"
                                         var="predio" rows="5" paginator="true" paginatorPosition="top" filterEvent="enter" 
                                         style="width: 98%" 
                                         selection="#{patenteView.predio}" rowKey="#{predio.id}"
                                         emptyMessage="No tiene datos">
                                <p:ajax event="rowSelectRadio"  update="frmPredios:btnSelectPredio" />
                                <p:column headerText="*" selectionMode="single" style="width:30px;text-align:center" filterMatchMode="contains"/>
                                <p:column headerText="# Predio" filterBy="#{predio.numPredio}" width="80" filterStyle="width: 80%;">
                                    <center><h:outputText value="#{predio.numPredio}"/></center>
                                </p:column>
                                <p:column headerText="Clave catastral" filterBy="#{predio.claveCat}" width="200" filterMatchMode="contains">
                                    <center><h:outputText value="#{predio.claveCat}"/></center>
                                </p:column>
                                <p:column headerText="Tipo" filterBy="#{predio.tipoPredio}" width="200" filterMatchMode="contains">
                                    <center><h:outputText value="#{predio.tipoPredio}"/></center>
                                </p:column>
                                <p:column headerText="Contibuyentes" filterBy="#{predio.nombrePropietarios}" width="200" filterMatchMode="contains">
                                    <center><h:outputText value="#{predio.nombrePropietarios}"/></center>
                                </p:column>

                                <p:column headerText="Direccion" filterBy="#{predio.direccion}" filterMatchMode="contains">
                                    <center><h:outputText value="#{predio.direccion}"/></center>
                                </p:column>
                            </p:dataTable>
                        </div>
                        <center>
                            <p:commandButton disabled="#{patenteView.predio.id eq null}" id="btnSelectPredio" 
                                             actionListener="#{patenteView.predioSeleccionado()}" value="Aceptar"  style="height: 30px; margin-top: 10px;" 
                                             update=":frmNew" />
                        </center>
                    </h:form>
                </p:dialog> 

                <p:dialog id="dlgSubida" widgetVar="dlgSubida" appendTo="@(body)" modal="true" header="Carga de fotos" width="65%" height="500" closable="true" closeOnEscape="true">
                    <h:form id="frmSubFotos">

                        <p:fileUpload mode="advanced"
                                      multiple="false"
                                      uploadLabel="Subir"                                     
                                      label="Seleccionar"  immediate="true"
                                      sequential="true"
                                      cancelLabel="Cancelar"
                                      oncomplete="PF('dlgSubida').hide()"
                                      allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                      invalidFileMessage="solo se acepta extensiones como gif | jpg | jpeg | png"
                                      update="frmSubFotos,:frmNew"
                                      fileUploadListener="#{patenteView.subirIamgenes}"/>
                    </h:form>
                </p:dialog>

                <!--Visualizador de Fotos-->
                <p:dialog   widgetVar="dlgFoto" appendTo="@(body)" modal="true" header="Foto: " width="45%" height="80%" closable="true" closeOnEscape="true">
                    <h:form id="frmFotos">
                        <!--<p:growl autoUpdate="true" showDetail="true"/>-->
                        <center>
                            <h2 style="color: #0033FF">#{patenteView.localComercialFotoSeleccionada.nombre}</h2>
                        </center>
                        <hr/>
                        <br/>
                        <p:graphicImage id="myImage" url="/images?ruta=#{patenteView.localComercialFotoSeleccionada.ruta}" 
                                        alt="Descripcion: #{patenteView.localComercialFotoSeleccionada.descripcion}"
                                        title="#{patenteView.localComercialFotoSeleccionada.nombre}" style="width: 100%; height: 400px"/> 
                        <pe:imageRotateAndResize id="rotateAndResize" for="myImage" widgetVar="rotateAndResizeWidget"/>
                        <!--                                <f:facet name="footer">
                                                            <div align="center">
                                                                <p:panelGrid columns="5" layout="grid">
                                                                    <p:commandButton icon="ui-icon-arrowreturnthick-1-w" onclick="PF('rotateAndResizeWidget').rotateLeft(90)"/>
                                                                    <p:commandButton icon="ui-icon-arrowreturnthick-1-e" onclick="PF('rotateAndResizeWidget').rotateRight(90)"/>
                                                                    <p:commandButton icon="ui-icon-zoomin" onclick="PF('rotateAndResizeWidget').scale(1.05)"/>
                                                                    <p:commandButton icon="ui-icon-zoomout" onclick="PF('rotateAndResizeWidget').scale(0.95)"/>
                                                                </p:panelGrid>
                                                            </div>
                                                        </f:facet>-->

                    </h:form>
                </p:dialog>
                <p:confirmDialog global="true">
                    <center>
                        <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                        <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                    </center>
                </p:confirmDialog>
            </div>
        </div>
        <p:dialog widgetVar="dlogoView" position="center" header="Patente" 
                  modal="true" width="90%" resizable="false" id="dlogoView" height="500"
                  closable="true" closeOnEscape="true" >
            <h:form id="frmView" >
                <ui:include src="_informacionPatente.xhtml" />
            </h:form>
        </p:dialog>
        <p:dialog widgetVar="dlogMemo" position="center" header="MEMO" modal="true" width="90%" resizable="false" id="dlogMemo" closable="true" closeOnEscape="true">           
            <h:form id="frmMemo" prependId="false">
                <center>
                    <p:commandButton  value="mantenimiento Secuencial" actionListener="#{patenteView.opneSecuencia()}"/>
                </center>
                <p:panelGrid columns="3" layout="grid" columnClasses="ui-g-4,ui-g-4,ui-g-4" styleClass="ui-panelgrid-blank">
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="No.Memo: " class="FontBold"/>
                        <p:inputText value="#{patenteView.numMemorandum}" style="width: 100%;" readonly="true">
                            <p:keyFilter mask="num"/>
                        </p:inputText>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Fecha: " class="FontBold"/>
                        <p:inputText value="#{patenteView.fechaMemo}" style="width: 100%;"/>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Para: " class="FontBold"/>
                        <p:inputText value="#{patenteView.para}" style="width: 100%;"/>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Asunto: " class="FontBold"/>
                        <p:inputText value="#{patenteView.asunto}" style="width: 100%;"/>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="No.Trámite: " class="FontBold"/>
                        <p:inputText value="#{patenteView.numTramite}" style="width: 100%;"/>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Memo Descriptivo: " class="FontBold"/>
                        <p:inputText value="#{patenteView.memoDescripcion}" style="width: 100%;"/>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Pertenciente: " class="FontBold"/>
                        <p:inputText value="#{patenteView.nombres}"  style="width: 100%;"/>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Código Local: " class="FontBold"/>
                        <p:inputText value="#{patenteView.codigoLocal}"  style="width: 100%;"/>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Ubicación: " class="FontBold"/>
                        <p:inputText value="#{patenteView.ubicacionLocal}"  style="width: 100%;"/>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="No.Memorándum (Adjuntar): " class="FontBold"/>
                        <p:inputText value="#{patenteView.descrpcioFinal}"  style="width: 100%;"/>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Director del Dpto. Justicia y Vigilancia: " class="FontBold"/>
                        <p:inputText value="#{patenteView.director}" style="width: 100%;"/>
                    </p:panelGrid>
                </p:panelGrid>
                <br/>
                <center>
                    <p:commandButton value="Generar Memo" icon="fa fa-print" actionListener="#{patenteView.generarMemo()}" process="frmMemo" style="width: auto;"/>
                </center>
            </h:form>           
        </p:dialog>

        <p:dialog widgetVar="dlogoManSecuen" position="center" header="Mantenimiento Secuencia" 
                  modal="true" width="300" resizable="false" id="dlogoManSecuen" closable="true" closeOnEscape="true">           
            <h:form id="frmManSecuencia" prependId="false">
                <p:panelGrid columns="2" layout="grid" columnClasses="ui-g-6,ui-g-6" styleClass="ui-panelgrid-blank">
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Ultimo Secuencial:" class="FontBold"/>
                        <p:inputText value="#{patenteView.mantenimientoSecuencia.num}">
                            <p:keyFilter mask="num"/>
                        </p:inputText>
                    </p:panelGrid>
                    <p:panelGrid columns="1" style="width: 100%;">
                        <p:outputLabel value="Año:" class="FontBold"/>
                        <p:inputText value="#{patenteView.anioMan}">
                            <p:keyFilter mask="num"/>
                        </p:inputText>
                    </p:panelGrid>
                </p:panelGrid>
                <center>
                    <p:commandButton icon="fa fa-save" value="Guardar" style="width: auto;" actionListener="#{patenteView.saveSecuencia()}"  process="frmManSecuencia"/>
                </center>
            </h:form>           
        </p:dialog>

    </ui:define>
</ui:composition>