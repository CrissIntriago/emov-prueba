<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:sigef="http://xmlns.jcp.org/jsf/composite/sigef/components"
                template="/WEB-INF/template/template.xhtml">

    <ui:define name="title">
        Comprobante de Pagos
    </ui:define>
    <ui:param name="tittle" value="COMPROBANTE DE PAGOS" />
    <ui:define name="content">
        <div class="ui-g ui-fluid">
            <div class="ui-g-12" >
                <h:form id="formMain" prependId="false">
                    <div class="ui-inputgroup" style="margin-bottom: 20px">
                        <p:selectOneMenu value="#{comprobantePagoView.periodo}"  style="width: 30%;border:1px solid #00796B;text-align: center"
                                         disabled="#{!comprobantePagoView.ocultarTabla}">
                            <f:selectItem itemValue="#{null}" itemLabel="-Seleccionar Período" itemDisabled="true"/>
                            <f:selectItems value="#{comprobantePagoView.listaPeriodo}" var="p" itemLabel="#{p.nombre}" itemValue="#{p.anio}"/>
                        </p:selectOneMenu>
                        <p:commandButton icon="fa fa-refresh"  actionListener="#{comprobantePagoView.cargarRegistros()}" 
                                         rendered="#{comprobantePagoView.ocultarTabla}" update="comprobantePagoTable"
                                         style="border-radius: 0px;width: 50px" title="Actualizar Registros"/>
                        <p:commandButton icon="fa fa-plus" actionListener="#{comprobantePagoView.form(null,'NUEVO')}"
                                         rendered="#{comprobantePagoView.ocultarTabla}"
                                         style="border-radius: 0px;width: 50px" title="Nuevo Registro"/> 
                        <p:commandButton icon="fa fa-paint-brush" onclick="PF('comprobantePagoTable').clearFilters()"
                                         rendered="#{comprobantePagoView.ocultarTabla}" update="comprobantePagoTable"
                                         style="border-radius: 0px;width: 50px" title="Limpiar Filtro"/>
                        <p:commandButton id="mostrarColumnas" style="border-radius: 0px;width: 50px" icon="fa fa-table" 
                                         rendered="#{comprobantePagoView.ocultarTabla}" title="Columnas Visibles"/>
                        <p:columnToggler datasource="comprobantePagoTable" trigger="mostrarColumnas" />
                        <p:commandButton icon="fa fa-arrow-circle-left" actionListener="#{comprobantePagoView.form(null,'LISTADO')}"
                                         rendered="#{!comprobantePagoView.ocultarTabla}" update="formMain"
                                         style="border-radius: 0px;width: 50px" title="Regresar"/>
                    </div>
                    <h:panelGroup id="dataTableComprobantePagos" layout="block" rendered="#{comprobantePagoView.ocultarTabla}">
                        <p:dataTable  id="comprobantePagoTable" widgetVar="comprobantePagoTable" var="comprobantePago" value="#{comprobantePagoView.comprobantePagoLazy}" 
                                      paginator="true" rows="50" style="width: 100%;margin-top: 15px" rowKey="#{comprobantePago.id}"
                                      paginatorPosition="bottom" currentPageReportTemplate="Mostrando {startRecord}-{endRecord} de {totalRecords}" 
                                      paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                      rowsPerPageTemplate="50,60,70,100" lazy="true" selectionMode="single" 
                                      emptyMessage="No existe información con el criterio de busqueda especificado">
                            <p:column headerText="No. Compr." style="width: 6%;text-align: center" filterBy="#{comprobantePago.numComprobante}" sortBy="#{comprobantePago.numComprobante}">
                                <h:outputText value="#{comprobantePago.numComprobante}" />
                            </p:column>
                            <p:column headerText="Descripción" style="width: 55%;" filterBy="#{comprobantePago.detalle}" filterMatchMode="contains">
                                <h:outputText value="#{comprobantePago.detalle}" />
                            </p:column>
                            <p:column headerText="Fecha de Emisión" style="width: 9%;text-align: center" sortBy="#{comprobantePago.fechaComprobante}">
                                <h:outputText value="#{comprobantePago.fechaComprobante}" >
                                    <f:convertDateTime pattern="dd-MM-yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="No. Transf." style="width: 6%;text-align: center" filterBy="#{comprobantePago.diarioGeneral.numeroTransaccion}">
                                <h:outputText value="#{comprobantePago.diarioGeneral.numeroTransaccion}" />
                            </p:column>
                            <p:column headerText="Estado" style="width: 15%;text-align: center" filterBy="#{comprobantePago.estado}" >
                                <h:outputText value="#{comprobantePago.estado}" />
                            </p:column>
                            <p:column headerText="Acciones" style="width: 10%;text-align: center">
                                <p:commandLink actionListener="#{comprobantePagoView.form(comprobantePago,'visualizar')}" title="Visualizar" process="@this">
                                    <i class="fa fa-eye" style="font-size: 1.5em; margin-right: 3px; color: #0D47A1;"></i>
                                </p:commandLink>
                                <p:commandLink actionListener="#{comprobantePagoView.imprimirReporteComprobante(comprobantePago)}" title="Reimprimir" process="@this">
                                    <i class="fa fa-print" style="font-size: 1.5em; margin-right: 3px; color: #0D47A1;"></i>
                                </p:commandLink>
                                <p:commandLink actionListener="#{comprobantePagoView.openDlgEdit(comprobantePago)}" title="Editar" process="@this"
                                              rendered="#{comprobantePago.estado=='ANULADO'?false:comprobantePago.estado=='TRANSFERENCIA ANULADA'?false:true}">
                                    <i class="fa fa-edit" style="font-size: 1.5em; margin-right: 3px; color: #0D47A1;"></i>
                                </p:commandLink>
                                <p:commandLink actionListener="#{comprobantePagoView.anularComprobante(comprobantePago)}" title="Anular" process="@this" 
                                               rendered="#{comprobantePago.estado=='ANULADO'?false:comprobantePago.estado=='TRANSFERENCIA ANULADA'?false:comprobantePago.estado!='REGISTRADO' ?false:true}">
                                    <i class="fa fa-minus-circle" style="font-size: 1.5em; margin-right: 3px; color: #D84315;"></i>
                                    <p:confirm header="Confirmación de eliminación" message="Esta seguro de anular el comprobante Nº #{comprobantePago.numComprobante} ?" icon="fa fa-exclamation-triangle" />
                                </p:commandLink>
                            </p:column>
                        </p:dataTable>
                    </h:panelGroup>

                    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                        <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes GreenButton" icon="fa fa-check" />
                        <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no RedButton" icon="fa fa-times" />
                    </p:confirmDialog>

                    <h:panelGroup id="formComprobantePagos" layout="block" rendered="#{!comprobantePagoView.ocultarTabla}">
                        <div class="ui-g-12">
                            <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group" rendered="#{!comprobantePagoView.ocultarBotonesAcciones}">
                                <p:outputLabel value="ESTADO: #{comprobantePagoView.comprobantePago.estado}" style="font-weight: bold;font-size: 20px;float: right"/>
                            </p:panelGrid>
                        </div>
                        <div class="ui-g-12">
                            <div class="ui-g-6">
                                <p:fieldset legend="Detalle: Comprobante de Pago">
                                    <p:panelGrid columns="3" layout="grid" styleClass="ui-panelgrid-blank form-group">
                                        <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group" rendered="#{!comprobantePagoView.ocultarBotonesAcciones}">
                                            <p:outputLabel for="@next" value="Nº del Comprobante de Pago:" style="font-weight: bold"/>
                                            <p:inputText id="numeroComprobantePago" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'numeroComprobantePago')"
                                                         value="#{comprobantePagoView.comprobantePago.numComprobante}" readonly="true" /> 
                                        </p:panelGrid>
                                        <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group">
                                            <p:outputLabel for="@next" value="Período:" style="font-weight: bold"/>
                                            <p:inputText id="periodoComprobantePago" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'periodoComprobantePago')"
                                                         value="#{comprobantePagoView.comprobantePago.periodo}" readonly="true" /> 
                                        </p:panelGrid>
                                        <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group">
                                            <p:outputLabel for="@next" value="Fecha Comprobante:" style="font-weight: bold"/>
                                            <p:calendar id="fechaComprobantePago" pattern="dd/MM/yyyy" readonly="false" navigator="true" yearRange="c-100:c+100"
                                                        disabled="#{!comprobantePagoView.ocultarBotonesAcciones}"
                                                        value="#{comprobantePagoView.comprobantePago.fechaComprobante}" style="width: 100%" locale="es"/>
                                        </p:panelGrid>
                                    </p:panelGrid>
                                    <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group">
                                        <p:panelGrid  columns="1" styleClass="form-group ui-panelgrid-blank" layout="grid" >
                                            <p:outputLabel for="@next" value="Detalle:"  style="font-weight: bold"/>
                                            <p:inputTextarea id="detalle" rows="4" style="width: 100%;border: 1px solid #cccccc;text-transform: uppercase"
                                                             readonly="#{!comprobantePagoView.ocultarBotonesAcciones}" 
                                                             value="#{comprobantePagoView.comprobantePago.detalle}"/> 
                                        </p:panelGrid> 
                                    </p:panelGrid>
                                </p:fieldset>
                            </div>
                            <div class="ui-g-6">
                                <p:fieldset legend="CONTABILIDAD">
                                    <p:panelGrid columns="3" layout="grid" styleClass="ui-panelgrid-blank form-group" id="gridContabilidad">
                                        <h:panelGroup>
                                            <p:outputLabel for="@next" value="Nº de Transacción:" style="font-weight: bold"/>
                                            <div class="ui-inputgroup">
                                                <p:inputText id="numTransaccion" class="panelInput" value="#{comprobantePagoView.diarioGeneral.numeroTransaccion}"
                                                             readonly="#{!comprobantePagoView.ocultarBotonesAcciones}" 
                                                             onkeypress="focusNextOnEnter(event, 'botonBusquedaDiarioGeneral')">
                                                    <p:keyFilter regEx="/[\d]/"/>
                                                </p:inputText>
                                                <p:commandButton title="Diarios Generales" icon="fa fa-search" id="botonBusquedaDiarioGeneral"
                                                                 actionListener="#{comprobantePagoView.buscarDiarioGeneral('BOTONBUSQUEDA')}"
                                                                 rendered="#{comprobantePagoView.ocultarBotonesAcciones}"
                                                                 process="numTransaccion,fechaComprobantePago" update="gridContabilidad,gridReservaCompromiso" styleClass="green-button button-group">
                                                </p:commandButton>
                                            </div>
                                        </h:panelGroup>
                                        <h:panelGroup layout="block" style="width: 100%;" class="panelInput" >
                                            <p:outputLabel for="@next" value="Período:" style="font-weight: bold"/>
                                            <p:inputText id="periodoDiarioGeneral" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'periodoDiarioGeneral')"
                                                         value="#{comprobantePagoView.diarioGeneral.periodo}" readonly="true" /> 
                                        </h:panelGroup>
                                        <h:panelGroup layout="block" style="width: 100%;" class="panelInput" >
                                            <p:outputLabel for="@next" value="Fecha Transacción:" style="font-weight: bold"/>
                                            <p:inputText id="fechaDiarioGeneral" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'fechaDiarioGeneral')"
                                                         value="#{comprobantePagoView.diarioGeneral.fechaElaboracion}" readonly="true" >
                                                <f:convertDateTime pattern="dd/MM/yyyy" />
                                            </p:inputText>
                                        </h:panelGroup>
                                    </p:panelGrid>
                                </p:fieldset>
                                <p:fieldset legend="RESERVA DE COMPROMISO">
                                    <p:panelGrid columns="3" layout="grid" styleClass="ui-panelgrid-blank form-group" id="gridReservaCompromiso">
                                        <h:panelGroup layout="block" style="width: 100%;" class="panelInput" >
                                            <p:outputLabel for="@next" value="Nº Reserva Compromiso:" style="font-weight: bold"/>
                                            <p:inputText id="numeroReservaCompromiso" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'numeroReservaCompromiso')"
                                                         value="#{comprobantePagoView.comprobantePago.reservaCompromiso.secuencial}" readonly="true" /> 
                                        </h:panelGroup>

                                        <h:panelGroup layout="block" style="width: 100%;" class="panelInput" >
                                            <p:outputLabel for="@next" value="Período:" style="font-weight: bold"/>
                                            <p:inputText id="periodoReservaCompromiso" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'periodoReservaCompromiso')"
                                                         value="#{comprobantePagoView.comprobantePago.reservaCompromiso.periodo}" readonly="true" /> 
                                        </h:panelGroup>

                                        <h:panelGroup layout="block" style="width: 100%;" class="panelInput" >
                                            <p:outputLabel for="@next" value="Fecha:" style="font-weight: bold"/>
                                            <p:inputText id="fechaReservaCompromiso" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'fechaReservaCompromiso')"
                                                         value="#{comprobantePagoView.comprobantePago.reservaCompromiso.fechaSolicitud}" readonly="true" >
                                                <f:convertDateTime pattern="dd/MM/yyyy" />
                                            </p:inputText> 
                                        </h:panelGroup>
                                    </p:panelGrid>
                                </p:fieldset>
                                <p:fieldset legend="BENEFICIARIO">
                                    <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank form-group">
                                        <h:panelGroup layout="block" style="width: 100%;" class="panelInput" >
                                            <p:outputLabel for="@next" value="RUC/C.I." style="font-weight: bold"/>
                                            <p:inputText id="identificacionBeneficiario" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'identificacionBeneficiario')"
                                                         value="#{comprobantePagoView.comprobantePago.diarioGeneral.variosBeneficiarios==true ? 'NOMINA':comprobantePagoView.comprobantePago.diarioGeneral.beneficiario.identificacionCompleta}" readonly="true" /> 
                                        </h:panelGroup>
                                        <h:panelGroup layout="block" style="width: 100%;" class="panelInput" >
                                            <p:outputLabel for="@next" value="Razón Social:" style="font-weight: bold"/>
                                            <p:inputText id="nombreBeneficiario" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'nombreBeneficiario')"
                                                         value="#{comprobantePagoView.comprobantePago.diarioGeneral.variosBeneficiarios==true ? 'NOMINA': comprobantePagoView.comprobantePago.diarioGeneral.beneficiario.tipoIdentificacion=='RUC'?comprobantePagoView.comprobantePago.diarioGeneral.beneficiario.nombre:comprobantePagoView.comprobantePago.diarioGeneral.beneficiario.nombreCompleto}" readonly="true" /> 
                                        </h:panelGroup>
                                    </p:panelGrid>
                                </p:fieldset>
                            </div>
                        </div>
                        <div class="ui-g-12">
                            <p:fieldset legend="COMPROBANTE DE PAGO">
                                <p:commandButton value="AGREGAR CUENTA BANCOS" process="@this" actionListener="#{comprobantePagoView.openDlgCuentaBanco()}"
                                                 icon="fa fa-plus" styleClass="Fs16" style="width: auto; margin: 15px 0px;" rendered="#{comprobantePagoView.botonCuentaBanco}"/> 
                                <p:dataTable  id="detalleComprobantePagoTable" widgetVar="detalleComprobantePagoTable" var="detalleComprobantePago" paginator="true" rows="20" 
                                              style="width: 100%;" paginatorPosition="bottom" currentPageReportTemplate="Mostrando {startRecord}-{endRecord} de {totalRecords}" filterEvent="enter"
                                              paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                              rowsPerPageTemplate="20,30,40,50" lazy="true" value="#{comprobantePagoView.detalleComprobantePagoList}" rowKey="#{detalleComprobantePago.linea}"
                                              emptyMessage="No existe información con el criterio de busqueda especificado" editMode="cell" editable="true" >
                                    <p:column headerText="Línea" style="width: 2vw;text-align: center">
                                        <h:outputText value="#{detalleComprobantePago.linea}" />
                                    </p:column>
                                    <p:column headerText="Cuenta Contable" style="width: 4vw;text-align: center">
                                        <h:outputText value="#{detalleComprobantePago.cuentaContable.codigo}" />
                                    </p:column>
                                    <p:column headerText="Nombre de Cuenta Contable" style="width: 15vw;">
                                        <h:outputText value="#{detalleComprobantePago.cuentaContable.nombre}" />
                                    </p:column>
                                    <p:column headerText="Debe" style="width: 4vw;">
                                        <h:outputText value="#{detalleComprobantePago.debe}"  style="float: right">
                                            <f:convertNumber currencySymbol="$" type="currency" currencyCode="USD" locale="es_EC"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Haber" style="width: 4vw;">
                                        <h:outputText value="#{detalleComprobantePago.haber}"  style="float: right">
                                            <f:convertNumber currencySymbol="$" type="currency" currencyCode="USD" locale="es_EC"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Tipo" style="width: 5vw;text-align: center">
                                        <h:outputText value="#{detalleComprobantePago.tipoPago.texto}" />
                                    </p:column>
                                    <p:column headerText="Partida" style="width: 5vw;text-align: center">
                                        <h:outputText value="#{detalleComprobantePago.cedulaPresupuestaria}" />
                                    </p:column>
                                    <p:column headerText="Ejecutado" style="width: 4vw;">
                                        <h:outputText value="#{detalleComprobantePago.ejecutado}"  style="float: right">
                                            <f:convertNumber currencySymbol="$" type="currency" currencyCode="USD" locale="es_EC"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:columnGroup type="footer">
                                        <p:row >
                                            <p:column colspan="3" style="text-align:right;font-weight: bold; font-size: 13px;" footerText="Suma:" />
                                            <p:column style="text-align: right;font-weight: bold; font-size: 13px;">
                                                <f:facet name="footer">
                                                    <h:outputText value="#{comprobantePagoView.totalDebe}">
                                                        <f:convertNumber type="currency" currencySymbol="$" currencyCode="USD" locale="es_EC"/>
                                                    </h:outputText>
                                                </f:facet>
                                            </p:column>

                                            <p:column  style="text-align: right;font-weight: bold; font-size: 13px;">
                                                <f:facet name="footer">
                                                    <h:outputText value="#{comprobantePagoView.totalHaber}">
                                                        <f:convertNumber type="currency" currencySymbol="$" currencyCode="USD" locale="es_EC"/>
                                                    </h:outputText>
                                                </f:facet>
                                            </p:column>
                                            <p:column colspan="2" style="text-align:right;font-weight: bold; font-size: 13px;" footerText="" />
                                            <p:column style="text-align: right;font-weight: bold; font-size: 13px;">
                                                <f:facet name="footer">
                                                    <h:outputText value="#{comprobantePagoView.totalValor}">
                                                        <f:convertNumber type="currency" currencySymbol="$" currencyCode="USD" locale="es_EC"/>
                                                    </h:outputText>
                                                </f:facet>
                                            </p:column>
                                        </p:row>
                                    </p:columnGroup>
                                </p:dataTable>
                            </p:fieldset>
                            <p:fieldset legend="BENEFICIARIO" style="margin-top: 10px">
                                <p:dataTable  id="beneficiarioTable" widgetVar="beneficiarioTable" var="beneficiario" paginator="true" rows="20" 
                                              style="width: 100%;" paginatorPosition="bottom" currentPageReportTemplate="Mostrando {startRecord}-{endRecord} de {totalRecords}" filterEvent="enter"
                                              paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                              rowsPerPageTemplate="20,30,40,50" lazy="true" value="#{comprobantePagoView.beneficiarioComprobantePagoList}" rowKey="#{beneficiario.numeroTransferencia}"
                                              emptyMessage="No existe información con el criterio de busqueda especificado">
                                    <p:column headerText="Cuenta Bancaria" style="width: 4vw;text-align: center">
                                        <h:outputText value="#{beneficiario.detalleBanco.cuentaBanco}" />
                                    </p:column>
                                    <p:column headerText="Nombre del Banco" style="width: 8vw;">
                                        <h:outputText value="#{beneficiario.detalleBanco.banco.nombreBanco}" />
                                    </p:column>
                                    <p:column headerText="Tipo Cuenta" style="width: 5vw;text-align: center">
                                        <h:outputText value="#{beneficiario.detalleBanco.tipoCuenta.texto}" />
                                    </p:column>
                                    <p:column headerText="Nombre Beneficiario" style="width: 8vw;">
                                        <h:outputText value="#{beneficiario.beneficiario.tipoIdentificacion.codigo == 'RUC' ? beneficiario.beneficiario.nombre:beneficiario.beneficiario.nombreCompleto}" />
                                    </p:column>
                                    <p:column headerText="Nº de Transferencia" style="width: 4vw;text-align: center">
                                        <h:outputText value="#{beneficiario.numeroTransferencia}" />
                                    </p:column>
                                    <p:column headerText="Valor" style="width: 3vw;">
                                        <h:outputText value="#{beneficiario.valor}" style="float: right">
                                            <f:convertNumber currencySymbol="$" type="currency" currencyCode="USD" locale="es_EC"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Estado" style="width:4vw;text-align: center" rendered="#{!comprobantePagoView.ocultarBotonesAcciones}">
                                        <h:outputText value="#{beneficiario.estadoBeneficiario}"/>
                                    </p:column>
                                    <p:columnGroup type="footer">
                                        <p:row >
                                            <p:column colspan="5" style="text-align:right;font-weight: bold; font-size: 13px;" footerText="Suma:" />
                                            <p:column style="text-align: right;font-weight: bold; font-size: 13px;">
                                                <f:facet name="footer">
                                                    <h:outputText value="#{comprobantePagoView.totalValorBeneficiarios}">
                                                        <f:convertNumber type="currency" currencySymbol="$" currencyCode="USD" locale="es_EC"/>
                                                    </h:outputText>
                                                </f:facet>
                                            </p:column>
                                        </p:row>
                                    </p:columnGroup>
                                </p:dataTable>
                            </p:fieldset> 
                        </div>
                        <center>
                            <p:commandButton value="GUARDAR" icon="fa fa-save" actionListener="#{comprobantePagoView.saveComprobante()}" update="comprobantePagoTable" id="guardarCP"
                                             styleClass="Fs16" style="width: auto; margin: 20px 0px;" rendered="#{comprobantePagoView.ocultarBotonesAcciones}"/> 

                            <p:commandButton value="CANCELAR" icon="fa fa-remove" actionListener="#{comprobantePagoView.vaciarFormulario('CANCELAR')}" 
                                             styleClass="Fs16" style="width: auto; margin: 20px 0px 20px 15px;" rendered="#{comprobantePagoView.ocultarBotonesAcciones}"
                                             update="beneficiarioTable, detalleComprobantePagoTable, gridContabilidad, gridReservaCompromiso"/> 
                        </center>
                    </h:panelGroup>
                </h:form>
            </div>
        </div>

        <p:dialog id="cuentaBancoDLG" header="Cuenta Bancos" widgetVar="cuentaBancoDLG" width="50%" style="margin-top: 150px"
                  modal="true" showEffect="fade" hideEffect="fade" resizable="false" position="top">
            <h:form prependId="false">
                <p:outputPanel id="cuentaBancoForm" style="width: 100%;" >
                    <p:dataTable  id="cuentaBancoTable" widgetVar="cuentaBancoTable" var="cuentaBanco" 
                                  value="#{comprobantePagoView.cuentaBancariaLazyModel}" paginator="false" 
                                  style="width: 100%;" scrollable="true" scrollHeight="350" rows="30000"
                                  paginatorPosition="bottom" currentPageReportTemplate="Mostrando {startRecord}-{endRecord} de {totalRecords}"
                                  paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                  lazy="true" selectionMode="single" rowKey="#{cuentaBanco.id}" selection="#{comprobantePagoView.cuentaBancariaSelecionada}"
                                  emptyMessage="No existen cuentas con el criterio de busqueda especificado">
                        <p:ajax event="rowSelect" listener="#{comprobantePagoView.añadirCuentaBanco()}" process="@this"/>
                        <p:column headerText="Número de Cuenta Banco" style="width: 8vw;text-align: center">
                            <h:outputText value="#{cuentaBanco.numeroCuenta}"/>
                        </p:column>
                        <p:column headerText="Nombre de Cuenta Banco" style="width: 15vw;">
                            <h:outputText value="#{cuentaBanco.nombreCuentaBancaria}" />
                        </p:column>
                        <p:column headerText="Cuenta Contable" style="width: 15vw">
                            <h:outputText value="#{cuentaBanco.cuentaMovimiento.codigo}-#{cuentaBanco.cuentaMovimiento.nombre}"/>
                        </p:column>
                    </p:dataTable>
                </p:outputPanel>
            </h:form>
        </p:dialog>

        <p:dialog id="diarioGeneralDLG" header="TRANSACCIONES - DIARIO GENERAL" widgetVar="diarioGeneralDLG" width="75%" style="margin-top: 100px"
                  modal="true" showEffect="fade" hideEffect="fade" resizable="false" position="top" draggable="true">
            <h:form prependId="false">
                <p:outputPanel id="diarioGeneralForm" style="width: 100%;" >
                    <p:dataTable  id="diarioGeneralTable" widgetVar="diarioGeneralTable" var="diarioGeneral" value="#{comprobantePagoView.diarioGeneralList}" 
                                  scrollable="true" scrollHeight="300" rows="20000" style="width: 100%" 
                                  rowKey="#{diarioGeneral.id}" emptyMessage="No existen cuentas con el criterio de búsqueda especificado">
                        <f:facet name="header">
                            LISTADO DE TRANSACCIONES
                        </f:facet>
                        <p:column headerText="Nº de Transacción" style="width: 5vw;text-align: center" filterBy="#{diarioGeneral.numeroTransaccion}">
                            <h:outputText value="#{diarioGeneral.numeroTransaccion}" />
                        </p:column>
                        <p:column headerText="Estado" style="width: 5vw;text-align: center" filterBy="#{diarioGeneral.estadoTransaccion}">
                            <h:outputText value="#{diarioGeneral.estadoTransaccion}" />
                        </p:column>
                        <p:column headerText="Clase" style="width: 5vw;text-align: center" filterBy="#{diarioGeneral.estadoTransaccion}">
                            <h:outputText value="#{diarioGeneral.clase.texto}" />
                        </p:column>
                        <p:column headerText="Detalle" style="width: 15vw;text-align: center" filterBy="#{diarioGeneral}">
                            <h:outputText value="#{diarioGeneral.observacion}" />
                        </p:column>
                        <p:column headerText="Tipo" style="width: 5vw;text-align: center" filterBy="#{diarioGeneral.periodo}">
                            <h:outputText value="#{diarioGeneral.tipo.texto}" />
                        </p:column>
                        <p:column headerText="Fecha de Registro" style="width: 5vw;text-align: center">
                            <h:outputText value="#{diarioGeneral.fechaElaboracion}" >
                                <f:convertDateTime pattern="dd-MM-yyyy"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Seleccion" style="width: 2vw;text-align: center">
                            <p:commandLink actionListener="#{comprobantePagoView.DiarioGeneralSeleccionado(diarioGeneral,'DIALOG')}" title="SELECCIONAR" process="@this">
                                <i class="fa fa-plus-circle" style="font-size: 1.5em; margin-right: 8px; color: #99ff00;"></i>
                            </p:commandLink>
                        </p:column>
                    </p:dataTable>
                </p:outputPanel>
            </h:form>
        </p:dialog>

        <p:dialog id="comprobanteDiarioGeneralDLG" header="MENSAJE" widgetVar="comprobanteDiarioGeneralDLG" width="33%"
                  modal="true" showEffect="fade" hideEffect="fade" resizable="false" position="center">
            <h:form prependId="false">
                <p:outputPanel id="comprobanteTransferenciaForm" style="width: 100%;" >
                    <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group" >
                        <p:outputLabel value="¿DESEA GENERAR EL REPORTE DE LA TRANSACCION DEL DIARIO GENERAL INTEGRADO?" style="font-weight: bold"/>
                    </p:panelGrid>
                    <center>
                        <p:commandButton value="SI" icon="fa fa-check" actionListener="#{comprobantePagoView.generarArchivoDiarioGeneral(true)}"
                                         styleClass="Fs16" style="width: auto; margin: 20px 0px;"/> 
                        <p:commandButton value="NO" icon="fa fa-remove" actionListener="#{comprobantePagoView.generarArchivoDiarioGeneral(false)}" 
                                         styleClass="Fs16" style="width: auto; margin: 20px 0px 20px 15px;"/> 
                    </center>
                </p:outputPanel>
            </h:form>
        </p:dialog>

        <p:dialog id="comprobanteEditDLG" header="Formulario de Edición de Comprobante de Pago" widgetVar="comprobanteEditDLG" width="33%"
                  modal="true" showEffect="fade" hideEffect="fade" resizable="false" position="center">
            <h:form prependId="false">
                <p:outputPanel id="comprobanteEditFormDLG" style="width: 100%;">
                    <p:panelGrid columns="3" layout="grid" styleClass="ui-panelgrid-blank form-group">
                        <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group">
                            <p:outputLabel for="@next" value="NO. :" style="font-weight: bold"/>
                            <p:inputText id="numeroComprobantePagoEdit" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'numeroComprobantePagoEdit')"
                                         value="#{comprobantePagoView.comprobantePago.numComprobante}" readonly="true" /> 
                        </p:panelGrid>
                        <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group" id="EditPeriodo">
                            <p:outputLabel for="@next" value="PERÍODO:" style="font-weight: bold"/>
                            <p:inputText id="periodoComprobantePagoEdit" style="width: 100%;" onkeypress="focusNextOnEnter(event, 'periodoComprobantePagoEdit')"
                                         value="#{comprobantePagoView.comprobantePago.periodo}" readonly="true" /> 
                        </p:panelGrid>
                        <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group">
                            <p:outputLabel for="@next" value="FECHA:" style="font-weight: bold"/>
                            <p:calendar id="fechaComprobantePagoEdit" pattern="dd/MM/yyyy" readonly="false" navigator="true" yearRange="c-100:c+100"
                                        value="#{comprobantePagoView.comprobantePago.fechaComprobante}" style="width: 100%" locale="es">
                            <p:ajax event="dateSelect" listener="#{comprobantePagoView.getPeriodoSelecionado()}"/>
                            </p:calendar>
                        </p:panelGrid>
                    </p:panelGrid>
                    <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank form-group">
                        <p:panelGrid  columns="1" styleClass="form-group ui-panelgrid-blank" layout="grid" >
                            <p:outputLabel for="@next" value="DETALLE:"  style="font-weight: bold"/>
                            <p:inputTextarea id="detalleEdit" rows="4" style="width: 100%;border: 1px solid #cccccc;text-transform: uppercase"
                                             value="#{comprobantePagoView.comprobantePago.detalle}"/> 
                        </p:panelGrid> 
                    </p:panelGrid>
                    <center>
                         <p:commandButton value="GUARDAR" icon="fa fa-save" actionListener="#{comprobantePagoView.opnDlgSaveEdit()}"
                                          styleClass="Fs16" style="width: 150px;margin: 10px" update="dataTableComprobantePagos"/> 
                    </center>
                </p:outputPanel>
            </h:form>
        </p:dialog>

    </ui:define>

</ui:composition>
